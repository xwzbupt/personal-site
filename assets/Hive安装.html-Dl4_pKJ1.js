import{_ as i,c as a,a as n,o as l}from"./app-B_fBko6u.js";const e={};function t(p,s){return l(),a("div",null,[...s[0]||(s[0]=[n(`<div class="hint-container info"><p class="hint-container-title">单节点离线安装</p><p>这篇文章记录了对Hive做单节点、离线的安装。</p></div><h1 id="hive的安装" tabindex="-1"><a class="header-anchor" href="#hive的安装"><span>Hive的安装</span></a></h1><h2 id="一、安装hadoop" tabindex="-1"><a class="header-anchor" href="#一、安装hadoop"><span>一、安装Hadoop</span></a></h2><p>安装Hadoop是安装Hive的前置步骤。</p><p>Hadoop安装包下载地址：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fmirrors.tuna.tsinghua.edu.cn%2Fapache%2Fhadoop%2Fcommon%2Fhadoop-3.3.4%2Fhadoop-3.3.4.tar.gz" target="_blank" rel="noopener noreferrer">清华大学开源软件镜像站</a></p><p>将安装包上传到/opt目录</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进入到/opt目录</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /opt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 解压</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hadoop-3.3.4.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建安装目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hadoop</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将解压后的hadoop挪到创建的安装目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /opt/hadoop-3.3.4/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hadoop/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进入到安装目录</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hadoop/hadoop-3.3.4/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ll</span></span></code></pre></div><p>这里做单节点配置，可以参考<a href="https://hadoop.apache.org/docs/r3.3.4/hadoop-project-dist/hadoop-common/SingleCluster.html" target="_blank" rel="noopener noreferrer">官网配置</a>。</p><p>修改<code>core-site.xml</code></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /usr/local/hadoop/hadoop-3.3.4/etc/hadoop/core-site.xml</span></span>
<span class="line"><span># 在文件中添加以下内容</span></span>
<span class="line"><span>        &lt;property&gt;</span></span>
<span class="line"><span>                &lt;name&gt;fs.defaultFS&lt;/name&gt;</span></span>
<span class="line"><span>                &lt;value&gt;hdfs://127.0.0.1:9000&lt;/value&gt;</span></span>
<span class="line"><span>        &lt;/property&gt;</span></span>
<span class="line"><span>        &lt;property&gt;</span></span>
<span class="line"><span>                &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span></span>
<span class="line"><span>                &lt;!-- 自定义 hadoop 的工作目录 --&gt;</span></span>
<span class="line"><span>                &lt;value&gt;/usr/local/hadoop/hadoop-3.3.4/tmp&lt;/value&gt;</span></span>
<span class="line"><span>        &lt;/property&gt;</span></span>
<span class="line"><span>        &lt;property&gt;</span></span>
<span class="line"><span>                &lt;name&gt;hadoop.native.lib&lt;/name&gt;</span></span>
<span class="line"><span>                &lt;!-- 禁用Hadoop的本地库 --&gt;</span></span>
<span class="line"><span>                &lt;value&gt;false&lt;/value&gt;</span></span>
<span class="line"><span>        &lt;/property&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改<code>hdfs-site.xml</code></p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /usr/local/hadoop/hadoop-3.3.4/etc/hadoop/hdfs-site.xml</span></span>
<span class="line"><span># 在文件中添加以下内容</span></span>
<span class="line"><span>   &lt;property&gt;</span></span>
<span class="line"><span>       &lt;name&gt;dfs.replication&lt;/name&gt;</span></span>
<span class="line"><span>       &lt;value&gt;1&lt;/value&gt;</span></span>
<span class="line"><span>   &lt;/property&gt;</span></span></code></pre></div><p>修改<code>yarn-site.xml</code></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /usr/local/hadoop/hadoop-3.3.4/etc/hadoop/yarn-site.xml</span></span>
<span class="line"><span># 在文件中添加以下内容</span></span>
<span class="line"><span>       &lt;property&gt;</span></span>
<span class="line"><span>               &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</span></span>
<span class="line"><span>               &lt;value&gt;127.0.0.1&lt;/value&gt;</span></span>
<span class="line"><span>       &lt;/property&gt;</span></span>
<span class="line"><span>       &lt;property&gt;</span></span>
<span class="line"><span>               &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;</span></span>
<span class="line"><span>               &lt;!-- yarn web 页面 --&gt;</span></span>
<span class="line"><span>               &lt;value&gt;0.0.0.0:8088&lt;/value&gt;</span></span>
<span class="line"><span>       &lt;/property&gt;</span></span>
<span class="line"><span>       &lt;property&gt;</span></span>
<span class="line"><span>               &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span></span>
<span class="line"><span>               &lt;!-- reducer获取数据的方式 --&gt;</span></span>
<span class="line"><span>               &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span></span>
<span class="line"><span>       &lt;/property&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改<code>mapred-site.xml</code></p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /usr/local/hadoop/hadoop-3.3.4/etc/hadoop/mapred-site.xml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        &lt;property&gt;</span></span>
<span class="line"><span>                &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span></span>
<span class="line"><span>                &lt;value&gt;yarn&lt;/value&gt;</span></span>
<span class="line"><span>        &lt;/property&gt;</span></span></code></pre></div><p>修改<code>hadoop-evn.sh</code></p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /usr/local/hadoop/hadoop-3.3.4/etc/hadoop/hadoop-env.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 将当前用户 root 赋给下面这些变量</span></span>
<span class="line"><span>export HDFS_NAMENODE_USER=root</span></span>
<span class="line"><span>export HDFS_DATANODE_USER=root</span></span>
<span class="line"><span>export HDFS_SECONDARYNAMENODE_USER=root</span></span>
<span class="line"><span>export YARN_RESOURCEMANAGER_USER=root</span></span>
<span class="line"><span>export YARN_NODEMANAGER_USER=root</span></span>
<span class="line"><span></span></span>
<span class="line"><span># JDK 安装路径，参考 cat /etc/profile |grep JAVA_HOME</span></span>
<span class="line"><span>export JAVA_HOME=/usr/java/</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Hadop 安装路径下的 ./etc/hadoop 路径</span></span>
<span class="line"><span>export HADOOP_CONF_DIR=/usr/local/hadoop/hadoop-3.3.4/etc/hadoop</span></span></code></pre></div><p>以上是修改Hadoop配置文件的内容，接下来配置Hadoop的环境变量</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /etc/profile</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#加入以下内容</span></span>
<span class="line"><span>export HADOOP_HOME=/usr/local/hadoop/hadoop-3.3.4</span></span>
<span class="line"><span>export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 使环境变量生效</span></span>
<span class="line"><span>source /etc/profile</span></span>
<span class="line"><span># 检查 PATH 中是否包含 $HADOOP_HOME/bin:$HADOOP_HOME/sbin 对应的目录</span></span>
<span class="line"><span>echo $PATH</span></span></code></pre></div><p>修改hosts文件，将当前主机名配置进去</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看当前主机名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hostname</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 此处结果为 localhost.localdomain</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改 hosts 文件，将当前主机名配到 127.0.0.1 后面</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ping 当前主机名进行检测</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ping</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost.localdomain</span></span></code></pre></div><p>配置本机ssh免密登录</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ssh-keygen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rsa</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">touch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> authorized_keys</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 600</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> authorized_keys</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> id_rsa.pub</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">authorized_keys</span></span></code></pre></div><p>在首次启动时需要格式化HDFS</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hdfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> namenode</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -format</span></span></code></pre></div><p>启动Hadoop，被执行的脚本是<code>/usr/local/hadoop/hadoop-3.3.4/sbin/start-all.sh</code>，之前已经通过<code>$HADOOP_HOME/sbin</code>配置到了环境变量中，可以直接执行。</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start-all.sh</span></span></code></pre></div><p>测试HDFS</p><div class="language-bash line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="bash" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在HDFS上创建目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /test_1/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#将本地文件上传到HDFS中</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 新建文本文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test_file_1.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 向文本中写入字符串 123</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 123</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;&amp;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">test_file_1.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将文本上传到 HDFS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -put</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test_file_1.txt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /test_1/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /test_1/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#查看HDFS上文本文件的内容</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /test_1/test_file_1.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将HDFS上的文件下载到本地</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 先删除本地的同名文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test_file_1.txt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ll</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将 HDFS 上的文件下载到本地</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /test_1/test_file_1.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>测试Hadoop Web页面</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙放行 9870 tcp 端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --zone=public</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=9870/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙重新加载</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre></div><p>浏览器访问：<code>ip:9870</code></p><p>Yarn Web页面测试</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙放行 8088 tcp 端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --zone=public</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=8088/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙重新加载</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre></div><p>浏览器访问：\`ip:8088</p><h2 id="二、安装hive" tabindex="-1"><a class="header-anchor" href="#二、安装hive"><span>二、安装Hive</span></a></h2><div class="hint-container tip"><p class="hint-container-title">前置条件</p><p>安装好JDK，配置好环境变量。</p></div><p><strong>（2）安装Hive</strong></p><div class="hint-container tip"><p class="hint-container-title">前置条件</p><p>安装好Hadoop。</p></div><p>Hive安装包下载地址：<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz" target="_blank" rel="noopener noreferrer">清华大学镜像站</a></p><p>将安装包上传到/opt目录</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进入到/opt目录</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /opt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 解压</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-hive-3.1.3-bin.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建安装目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将解压后的hive挪到创建的安装目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /opt/apache-hive-3.1.3-bin/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进入到安装目录</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ll</span></span></code></pre></div><p>在Hive的conf目录下创建hive-site.xml配置文件，并写入如下内容。</p><div class="language- line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /usr/local/hive/apache-hive-3.1.3-bin/conf/hive-site.xml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;configuration&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;!--hive 元数据库的JDBC驱动类，这里选则 MySQL--&gt;</span></span>
<span class="line"><span>        &lt;value&gt;com.mysql.cj.jdbc.Driver&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;!--hive_metadata 为 hive 元数据在 MySQL 中的库名，注意字符集设置，由于是在XML中，URL中的&amp;需要转译为&amp;--&gt;</span></span>
<span class="line"><span>        &lt;value&gt;jdbc:mysql://127.0.0.1:3306/hive_metadata?createDatabaseIfNotExist=true&amp;amp;characterEncoding=UTF-8&amp;amp;useSSL=false&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;!--MySQL登录账户名--&gt;</span></span>
<span class="line"><span>        &lt;value&gt;root&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;!--MySQL登录密码--&gt;</span></span>
<span class="line"><span>        &lt;value&gt;123456&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;!--hive 表数据在 HDFS 的默认位置。创建内部表时，如果不指定 location，表数据则存储与该位置。--&gt;</span></span>
<span class="line"><span>        &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;value&gt;/user/hive/warehouse/internal&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;!--hive 外部表数据在 HDFS 的默认位置。创建外部表时，如果不指定 location，表数据则存储与该位置。--&gt;</span></span>
<span class="line"><span>        &lt;name&gt;hive.metastore.warehouse.external.dir&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;value&gt;/user/hive/warehouse/external&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    &lt;property&gt;</span></span>
<span class="line"><span>        &lt;name&gt;hive.server2.enable.doAs&lt;/name&gt;</span></span>
<span class="line"><span>        &lt;value&gt;false&lt;/value&gt;</span></span>
<span class="line"><span>    &lt;/property&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/configuration&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p><a href="http://xn--hive-env-8q7m267h.sh" target="_blank" rel="noopener noreferrer">创建hive-env.sh</a>，将conf目录下的<code>hive-env.sh.template</code>复制一份并重命名为<code>hive-env.sh</code>。</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/conf/hive-env.sh.template</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/conf/hive-env.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/conf/hive-env.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将 HADOOP_HOME 的注释放开，其值改为本机 Hadoop 的安装目录 /usr/local/hadoop/hadoop-3.3.4</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HADOOP_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/hadoop/hadoop-3.3.4</span></span></code></pre></div><p>安装MySQL jdbc jar包，其中jar包版本和MySQL版本对应如下：</p><table><thead><tr><th style="text-align:left;">mysql-connector-java</th><th style="text-align:left;">MySQL</th><th style="text-align:left;">JDK</th><th style="text-align:left;">补充</th></tr></thead><tbody><tr><td style="text-align:left;">8.0.x</td><td style="text-align:left;">5.6、5.7、8.0 4.2</td><td style="text-align:left;">JDK 8.0或更高版本</td><td style="text-align:left;">全面上市。推荐版本。</td></tr><tr><td style="text-align:left;">5.1.x</td><td style="text-align:left;">5.6、5.7、8.0 3.0、4.0、4.1、4.2</td><td style="text-align:left;">JDK 5.0和JDK 8.0或更高版本</td><td style="text-align:left;">一般可用性</td></tr></tbody></table><p><a href="https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.30/mysql-connector-java-8.0.30.jar" target="_blank" rel="noopener noreferrer">下载地址</a>。下载后将其传到\`\`/usr/local/hive/apache-hive-3.1.3-bin/lib\`下。</p><p>设置Hive的环境变量</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> HIVE_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">hive</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apache-hive-3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">3-bin</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$HIVE_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$PATH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 运行配置文件</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 检查 PATH 中是否包含 $HIVE_HOME/bin 对应的绝对路径</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $PATH</span></span></code></pre></div><p>初始化元数据库，指定元数据库为MySQL</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看MySQL是否启动</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysqld</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果没有启动，则启动MySQL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysqld</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">schematool</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -initSchema</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -dbType</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span></span></code></pre></div><p>注：<code>schematool</code> 命令位于 <code>/usr/local/hive/apache-hive-3.1.3-bin/bin/</code> ，已经配置在环境变量path中，可以直接使用。</p><p>启动Hadoop</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看Hadoop是否启动</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hadoop</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果没有启动，则启动Hadoop</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start-all.sh</span></span></code></pre></div><p>编写后台启动Hive的脚本。Hive有三种用户接口，如下图所示。</p><figure><img src="https://www.hanshuixin.com/prod-api/file/statics/2022/11/21/42f0e8b3-3fed-4ddd-9570-d6c7686ddc7d.png" alt="hive用户接口.png" tabindex="0" loading="lazy"><figcaption>hive用户接口.png</figcaption></figure><p>三种用户接口的启动方式分别如下：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Client，JDBC/ODBC + hive Server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hive</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> metastore</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hive</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hiveserver2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># CLI，命令行 + hive 副本</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hive</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cli</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 浏览器，WUI </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hive</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hwi</span></span></code></pre></div><p>本文选择第一种，同时启动metastore，编写后台启动脚本：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/bin/start-hive-metastore-hiveserver2.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nohup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hive</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> metastore</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/hive/apache-hive-3.1.3-bin/log/metastore.log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1 &amp;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nohup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hive</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hiveserver2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/hive/apache-hive-3.1.3-bin/log/hiveserver2.log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1 &amp;</span></span></code></pre></div><p>执行以下内容</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 赋予启动脚本执行权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/bin/start-hive-metastore-hiveserver2.sh</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建日志目录：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/log</span></span></code></pre></div><p>启动Hive</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start-hive-metastore-hiveserver2.sh</span></span></code></pre></div><p>查看两个日志，无报错即可</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tail</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -1000f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/log/metastore.log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tail</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -1000f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hive/apache-hive-3.1.3-bin/log/hiveserver2.log</span></span></code></pre></div><p>放行端口</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙放行 8042 tcp 端口，Hadoop http服务端口，可用于在浏览器查看yarn日志</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --zone=public</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=8042/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙放行 10000 tcp 端口，hive jdbc连接端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --zone=public</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=10000/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 防火墙重新加载</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre></div><p>在yarn-site.xml中添加Hadoop类路径</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#查看Hadoop类路径</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> classpath</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#编辑 Hadoop 的 yarn-site.xml 文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/hadoop/hadoop-3.3.4/etc/hadoop/yarn-site.xml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;property&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yarn.application.classpath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/name&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;!</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">--</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 输入刚才返回的Hadoop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> classpath路径</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/hadoop/hadoop-3.3.4/etc/hadoop:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/common/lib/*:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/common/*:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/hdfs:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/hdfs/lib/*:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/hdfs/*:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/mapreduce/*:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/yarn:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/yarn/lib/*:/usr/local/hadoop/hadoop-3.3.4/share/hadoop/yarn/*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/value&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/property&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#重启Hadoop</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stop-all.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start-all.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>到这里安装Hive就结束了，可以尝试使用Hive。</p>`,74)])])}const k=i(e,[["render",t]]),d=JSON.parse('{"path":"/bigdata/Hive%E5%AE%89%E8%A3%85.html","title":"Hive的安装","lang":"zh-CN","frontmatter":{"description":"单节点离线安装 这篇文章记录了对Hive做单节点、离线的安装。 Hive的安装 一、安装Hadoop 安装Hadoop是安装Hive的前置步骤。 Hadoop安装包下载地址：清华大学开源软件镜像站 将安装包上传到/opt目录 这里做单节点配置，可以参考官网配置。 修改core-site.xml 修改hdfs-site.xml 修改yarn-site.x...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Hive的安装\\",\\"image\\":[\\"https://www.hanshuixin.com/prod-api/file/statics/2022/11/21/42f0e8b3-3fed-4ddd-9570-d6c7686ddc7d.png\\"],\\"dateModified\\":\\"2025-06-21T15:03:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Weiser\\",\\"url\\":\\"https://github.com/xwzbupt\\"}]}"],["meta",{"property":"og:url","content":"https://vuepress-theme-hope-v2-demo.mrhope.site/bigdata/Hive%E5%AE%89%E8%A3%85.html"}],["meta",{"property":"og:site_name","content":"Weiser"}],["meta",{"property":"og:title","content":"Hive的安装"}],["meta",{"property":"og:description","content":"单节点离线安装 这篇文章记录了对Hive做单节点、离线的安装。 Hive的安装 一、安装Hadoop 安装Hadoop是安装Hive的前置步骤。 Hadoop安装包下载地址：清华大学开源软件镜像站 将安装包上传到/opt目录 这里做单节点配置，可以参考官网配置。 修改core-site.xml 修改hdfs-site.xml 修改yarn-site.x..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://www.hanshuixin.com/prod-api/file/statics/2022/11/21/42f0e8b3-3fed-4ddd-9570-d6c7686ddc7d.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-21T15:03:37.000Z"}],["meta",{"property":"article:modified_time","content":"2025-06-21T15:03:37.000Z"}]]},"git":{"createdTime":1750518217000,"updatedTime":1750518217000,"contributors":[{"name":"weiser","username":"weiser","email":"1134685563@qq.com","commits":1,"url":"https://github.com/weiser"}]},"readingTime":{"minutes":6.07,"words":1821},"filePathRelative":"bigdata/Hive安装.md","excerpt":"<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">单节点离线安装</p>\\n<p>这篇文章记录了对Hive做单节点、离线的安装。</p>\\n</div>\\n<h1>Hive的安装</h1>\\n<h2>一、安装Hadoop</h2>\\n<p>安装Hadoop是安装Hive的前置步骤。</p>\\n<p>Hadoop安装包下载地址：<a href=\\"https://links.jianshu.com/go?to=https%3A%2F%2Fmirrors.tuna.tsinghua.edu.cn%2Fapache%2Fhadoop%2Fcommon%2Fhadoop-3.3.4%2Fhadoop-3.3.4.tar.gz\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">清华大学开源软件镜像站</a></p>","autoDesc":true}');export{k as comp,d as data};
