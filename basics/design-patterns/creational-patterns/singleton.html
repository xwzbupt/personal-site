<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"å•ä¾‹æ¨¡å¼","image":["https://personal-site-pictures.oss-cn-beijing.aliyuncs.com/img/%E5%8D%95%E4%BE%8B1.jpg","https://personal-site-pictures.oss-cn-beijing.aliyuncs.com/img/%E5%8D%95%E4%BE%8B2.jpg"],"dateModified":"2025-06-21T15:03:37.000Z","author":[{"@type":"Person","name":"Weiser","url":"https://github.com/xwzbupt"}]}</script><meta property="og:url" content="https://vuepress-theme-hope-v2-demo.mrhope.site/basics/design-patterns/creational-patterns/singleton.html"><meta property="og:site_name" content="Weiser"><meta property="og:title" content="å•ä¾‹æ¨¡å¼"><meta property="og:description" content="å•ä¾‹æ¨¡å¼ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿ å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ å•ä¾‹ä¸é™æ€ç±»çš„åŒºåˆ«ï¼Ÿ æœ‰ä½•æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Ÿ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿ å•ä¾‹è®¾è®¡æ¨¡å¼ï¼ˆSingleton Design Patternï¼‰ç†è§£èµ·æ¥éå¸¸ç®€å•ã€‚ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–è€…å®ä¾‹ï¼‰ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«ä½œå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°å•ä¾‹æ¨¡å¼ã€‚ å¯¹äºå•ä¾‹çš„æ¦‚å¿µï¼Œæˆ‘è§‰å¾—æ²¡å¿…è¦è§£é‡Šå¤ªå¤šï¼Œä½ ä¸€çœ‹å°±èƒ½..."><meta property="og:type" content="article"><meta property="og:image" content="https://personal-site-pictures.oss-cn-beijing.aliyuncs.com/img/%E5%8D%95%E4%BE%8B1.jpg"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-06-21T15:03:37.000Z"><meta property="article:modified_time" content="2025-06-21T15:03:37.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap" rel="stylesheet"><title>å•ä¾‹æ¨¡å¼ | Weiser</title><meta name="description" content="å•ä¾‹æ¨¡å¼ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿ å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ å•ä¾‹ä¸é™æ€ç±»çš„åŒºåˆ«ï¼Ÿ æœ‰ä½•æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Ÿ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿ å•ä¾‹è®¾è®¡æ¨¡å¼ï¼ˆSingleton Design Patternï¼‰ç†è§£èµ·æ¥éå¸¸ç®€å•ã€‚ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–è€…å®ä¾‹ï¼‰ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«ä½œå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°å•ä¾‹æ¨¡å¼ã€‚ å¯¹äºå•ä¾‹çš„æ¦‚å¿µï¼Œæˆ‘è§‰å¾—æ²¡å¿…è¦è§£é‡Šå¤ªå¤šï¼Œä½ ä¸€çœ‹å°±èƒ½...">
    <link rel="preload" href="/assets/style-CTL1AhDr.css" as="style"><link rel="stylesheet" href="/assets/style-CTL1AhDr.css">
    <link rel="modulepreload" href="/assets/app-mRFOk-Ym.js"><link rel="modulepreload" href="/assets/singleton.html-9SgpbBxG.js">
    <link rel="prefetch" href="/assets/index.html-b1Wc3Xz-.js" as="script"><link rel="prefetch" href="/assets/followme.html-BIzq7OFR.js" as="script"><link rel="prefetch" href="/assets/home.html-DueaHX32.js" as="script"><link rel="prefetch" href="/assets/slide.html-D5-3x_QI.js" as="script"><link rel="prefetch" href="/assets/cv.html-DknCNYn6.js" as="script"><link rel="prefetch" href="/assets/guide.html-C-fieC0B.js" as="script"><link rel="prefetch" href="/assets/Apache Ranger.html-D8UlGxQ4.js" as="script"><link rel="prefetch" href="/assets/Hiveå®‰è£….html-DfSZhwdR.js" as="script"><link rel="prefetch" href="/assets/openLookeng.html-CWKex6bp.js" as="script"><link rel="prefetch" href="/assets/byrbt.html-CQJIwKa1.js" as="script"><link rel="prefetch" href="/assets/qinglong.html-CSJzGAvs.js" as="script"><link rel="prefetch" href="/assets/wechat.html-lIeLnnmq.js" as="script"><link rel="prefetch" href="/assets/refund.html-BSsra-cO.js" as="script"><link rel="prefetch" href="/assets/git.html-CZ52hJa3.js" as="script"><link rel="prefetch" href="/assets/linuxå‘½ä»¤.html-2KIErWrJ.js" as="script"><link rel="prefetch" href="/assets/å…å¯†ç™»å½•.html-BqCX-d7w.js" as="script"><link rel="prefetch" href="/assets/index.html-CNWdANTd.js" as="script"><link rel="prefetch" href="/assets/OOP.html-HqkiA_7B.js" as="script"><link rel="prefetch" href="/assets/åŸºäºæ¥å£è€ŒéåŸºäºå®ç°ç¼–ç¨‹.html-4MlSjpk-.js" as="script"><link rel="prefetch" href="/assets/å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿.html-BuRGEpFa.js" as="script"><link rel="prefetch" href="/assets/å®æˆ˜ä¸€ï¼šè´«è¡€å’Œå……è¡€æ¨¡å‹.html-UoFgw_DT.js" as="script"><link rel="prefetch" href="/assets/å®æˆ˜äºŒï¼šæ¥å£é‰´æƒ.html-BUAMlLCy.js" as="script"><link rel="prefetch" href="/assets/å°è£…-æŠ½è±¡-ç»§æ‰¿-å¤šæ€.html-BGCz8vgN.js" as="script"><link rel="prefetch" href="/assets/æ¥å£-æŠ½è±¡ç±».html-OAPzY-Ie.js" as="script"><link rel="prefetch" href="/assets/é¢å‘å¯¹è±¡çš„ä¼˜åŠ¿.html-BOMHv0Ls.js" as="script"><link rel="prefetch" href="/assets/1.æ•´æ•°ä¸“é¢˜.html-Bd2Fooen.js" as="script"><link rel="prefetch" href="/assets/10.å‰ç¼€æ ‘ä¸“é¢˜.html-Ca6nZsk3.js" as="script"><link rel="prefetch" href="/assets/11.äºŒåˆ†ä¸“é¢˜.html-DUtnTzW6.js" as="script"><link rel="prefetch" href="/assets/12.æ’åºä¸“é¢˜.html-LzMQgHE4.js" as="script"><link rel="prefetch" href="/assets/13.å›æº¯æ³•ä¸“é¢˜.html-hrrmu_b6.js" as="script"><link rel="prefetch" href="/assets/14.åŠ¨æ€è§„åˆ’ä¸“é¢˜.html-wvTFVMPv.js" as="script"><link rel="prefetch" href="/assets/15.å›¾.html-C4eGB4uq.js" as="script"><link rel="prefetch" href="/assets/16.æ¨¡æ‹Ÿ.html-DGxIv5qf.js" as="script"><link rel="prefetch" href="/assets/17.ç¬”è¯•é¢˜.html-D6L1QQwe.js" as="script"><link rel="prefetch" href="/assets/2.æ•°ç»„ä¸“é¢˜.html-BA_SJsrm.js" as="script"><link rel="prefetch" href="/assets/3.å­—ç¬¦ä¸²ä¸“é¢˜.html-CMlb-vod.js" as="script"><link rel="prefetch" href="/assets/4.é“¾è¡¨ä¸“é¢˜.html-D7G2PhUD.js" as="script"><link rel="prefetch" href="/assets/5.å“ˆå¸Œä¸“é¢˜.html-rH_hAyOe.js" as="script"><link rel="prefetch" href="/assets/6.æ ˆä¸“é¢˜.html-CK9FEcwt.js" as="script"><link rel="prefetch" href="/assets/7.é˜Ÿåˆ—ä¸“é¢˜.html-CGe7m34M.js" as="script"><link rel="prefetch" href="/assets/8.äºŒå‰æ ‘ä¸“é¢˜.html-D6PrQupz.js" as="script"><link rel="prefetch" href="/assets/9.å †ä¸“é¢˜.html-Cdiv4tI9.js" as="script"><link rel="prefetch" href="/assets/index.html-CoINIkOm.js" as="script"><link rel="prefetch" href="/assets/leetcode-hot-100.html-CSIZP4Kh.js" as="script"><link rel="prefetch" href="/assets/index.html-DMQqHvCG.js" as="script"><link rel="prefetch" href="/assets/D.html-BoPmjrIc.js" as="script"><link rel="prefetch" href="/assets/DRY.html-EghuZvxU.js" as="script"><link rel="prefetch" href="/assets/I.html-rmggrbuJ.js" as="script"><link rel="prefetch" href="/assets/KISS-YAGNI.html-C9mdRCjZ.js" as="script"><link rel="prefetch" href="/assets/L.html-DSDQjSvQ.js" as="script"><link rel="prefetch" href="/assets/LOD.html-DAW8eszl.js" as="script"><link rel="prefetch" href="/assets/O.html-BgGESzqG.js" as="script"><link rel="prefetch" href="/assets/S.html-BNELO9d0.js" as="script"><link rel="prefetch" href="/assets/å®æˆ˜ä¸€.html-N_-S4nQ4.js" as="script"><link rel="prefetch" href="/assets/å®æˆ˜äºŒ.html-AmzwBiJ4.js" as="script"><link rel="prefetch" href="/assets/2é˜¶æ®µå’Œ3é˜¶æ®µæäº¤.html-DjRf1Lzl.js" as="script"><link rel="prefetch" href="/assets/CAP_BASE.html-gVuSj-dw.js" as="script"><link rel="prefetch" href="/assets/Paxos.html-CAhkbmvq.js" as="script"><link rel="prefetch" href="/assets/Raft.html-eRHLIvQW.js" as="script"><link rel="prefetch" href="/assets/ä¸€è‡´æ€§å“ˆå¸Œ.html-BkuxWeEm.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html-C6PyFQJC.js" as="script"><link rel="prefetch" href="/assets/index.html-qDeBTF2m.js" as="script"><link rel="prefetch" href="/assets/lottery-design-patterns.html-BAeZVORE.js" as="script"><link rel="prefetch" href="/assets/tipsFromBYRForum.html-Y3HFfDNs.js" as="script"><link rel="prefetch" href="/assets/3pan.html-D73eEeBr.js" as="script"><link rel="prefetch" href="/assets/index.html-EswjoI98.js" as="script"><link rel="prefetch" href="/assets/cheat.html-BoF74HWU.js" as="script"><link rel="prefetch" href="/assets/compare.html-C4iAbExk.js" as="script"><link rel="prefetch" href="/assets/news.html-B6DLwnXa.js" as="script"><link rel="prefetch" href="/assets/options.html-Pdr3ryy2.js" as="script"><link rel="prefetch" href="/assets/shinianyimeng.html-invlxfbh.js" as="script"><link rel="prefetch" href="/assets/trading-management.html-TICOFY-1.js" as="script"><link rel="prefetch" href="/assets/trading-mindset.html-H0GsGtHY.js" as="script"><link rel="prefetch" href="/assets/trick.html-BwZj2M1h.js" as="script"><link rel="prefetch" href="/assets/xauusd.html-DUdPRXOC.js" as="script"><link rel="prefetch" href="/assets/basics.html-FQS0IujI.js" as="script"><link rel="prefetch" href="/assets/entry.html-BIHCvB3B.js" as="script"><link rel="prefetch" href="/assets/K.html-TO0uUoMt.js" as="script"><link rel="prefetch" href="/assets/bull-bear-power.html-qkJJgQwZ.js" as="script"><link rel="prefetch" href="/assets/key-position.html-DrCa2V18.js" as="script"><link rel="prefetch" href="/assets/learning-path.html-CamHrK0V.js" as="script"><link rel="prefetch" href="/assets/Bolling.html-58PP0iQc.js" as="script"><link rel="prefetch" href="/assets/EMA.html-BLUHG28l.js" as="script"><link rel="prefetch" href="/assets/Fibonacci.html-B4-veO82.js" as="script"><link rel="prefetch" href="/assets/MACD.html-C29SAp5j.js" as="script"><link rel="prefetch" href="/assets/ali-ac.html-BtLqCEaa.js" as="script"><link rel="prefetch" href="/assets/1_æ¶æ„.html-DBYU0dWq.js" as="script"><link rel="prefetch" href="/assets/2_æ—¥å¿—.html-CSk3Wr-H.js" as="script"><link rel="prefetch" href="/assets/3_ç´¢å¼•.html-BbCCclpH.js" as="script"><link rel="prefetch" href="/assets/4_äº‹åŠ¡.html-BeNQKqpI.js" as="script"><link rel="prefetch" href="/assets/5_é”.html-5zrvewgw.js" as="script"><link rel="prefetch" href="/assets/6_ä¼˜åŒ–.html-4eUIwL3_.js" as="script"><link rel="prefetch" href="/assets/1åŸºç¡€æ¶æ„-SQLæŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œ.html-Tp4A8PHY.js" as="script"><link rel="prefetch" href="/assets/2æ—¥å¿—ç³»ç»Ÿ-SQLæ›´æ–°è¯­å¥çš„æ‰§è¡Œ.html-DTHQz0n1.js" as="script"><link rel="prefetch" href="/assets/3äº‹åŠ¡éš”ç¦».html-ZSrA1K0H.js" as="script"><link rel="prefetch" href="/assets/4ç´¢å¼•ï¼ˆä¸Šï¼‰.html-BXjwQLGH.js" as="script"><link rel="prefetch" href="/assets/5ç´¢å¼•ï¼ˆä¸‹ï¼‰.html-CU3v2yZ1.js" as="script"><link rel="prefetch" href="/assets/6å…¨å±€é”å’Œè¡¨é”.html-Ow3M093v.js" as="script"><link rel="prefetch" href="/assets/7è¡Œé”.html-CaFvUZAC.js" as="script"><link rel="prefetch" href="/assets/8äº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„.html-Cq8wIthi.js" as="script"><link rel="prefetch" href="/assets/10ä¸ºä»€ä¹ˆæœ‰æ—¶ä¼šé€‰é”™ç´¢å¼•.html-BLeA_fS0.js" as="script"><link rel="prefetch" href="/assets/11ç»™å­—ç¬¦ä¸²åŠ å­—æ®µç´¢å¼•.html-D9OnP6k4.js" as="script"><link rel="prefetch" href="/assets/12ä¸ºä»€ä¹ˆæˆ‘çš„MySQLä¼šæŠ–ä¸€ä¸‹.html-BgWq8Ipk.js" as="script"><link rel="prefetch" href="/assets/13è¡¨æ•°æ®åˆ æ‰ä¸€åŠï¼Œä¸ºä»€ä¹ˆè¡¨æ–‡ä»¶å¤§å°ä¸å˜.html-D9YumBbA.js" as="script"><link rel="prefetch" href="/assets/14countè¿™ä¹ˆæ…¢è¯¥æ€ä¹ˆåŠ.html-CHLV5TVi.js" as="script"><link rel="prefetch" href="/assets/16orderbyæ˜¯æ€ä¹ˆå·¥ä½œçš„.html-CORUuGwx.js" as="script"><link rel="prefetch" href="/assets/17å¦‚ä½•æ­£ç¡®åœ°æ˜¾ç¤ºéšæœºæ¶ˆæ¯.html-MHpPiTEP.js" as="script"><link rel="prefetch" href="/assets/18SQLçš„æ€§èƒ½.html-D0v9y1pZ.js" as="script"><link rel="prefetch" href="/assets/19æŸ¥ä¸€è¡Œçš„è¯­å¥ä¹Ÿè¿™ä¹ˆæ…¢.html-BnCKMmqa.js" as="script"><link rel="prefetch" href="/assets/9æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•çš„é€‰æ‹©.html-CimbuoRL.js" as="script"><link rel="prefetch" href="/assets/Chain-Of-Responsibility.html-chNohR7D.js" as="script"><link rel="prefetch" href="/assets/Command.html-CZiMtST0.js" as="script"><link rel="prefetch" href="/assets/Interpreter.html-SN-r4_2H.js" as="script"><link rel="prefetch" href="/assets/Iterator.html-JjxnZibt.js" as="script"><link rel="prefetch" href="/assets/Mediator.html-CIS9C3tY.js" as="script"><link rel="prefetch" href="/assets/Memento.html-DQO6rnjl.js" as="script"><link rel="prefetch" href="/assets/Observer.html-DAioJ0Oa.js" as="script"><link rel="prefetch" href="/assets/index.html-muG6kLdC.js" as="script"><link rel="prefetch" href="/assets/State.html-DA5_f4LK.js" as="script"><link rel="prefetch" href="/assets/Strategy.html-DYd3OPFn.js" as="script"><link rel="prefetch" href="/assets/Template-method.html-790lVDPL.js" as="script"><link rel="prefetch" href="/assets/Visitor.html-ChUtRIXZ.js" as="script"><link rel="prefetch" href="/assets/index.html-CeMl9zim.js" as="script"><link rel="prefetch" href="/assets/builder.html-1vDVqmGU.js" as="script"><link rel="prefetch" href="/assets/factory-method.html-CAmjnMnP.js" as="script"><link rel="prefetch" href="/assets/prototype.html-DSpx-wVG.js" as="script"><link rel="prefetch" href="/assets/Adapter.html-DmhipSBg.js" as="script"><link rel="prefetch" href="/assets/Bridge.html-BDld9GoM.js" as="script"><link rel="prefetch" href="/assets/Composite.html-JjApkwaE.js" as="script"><link rel="prefetch" href="/assets/Decorator.html-BCp_0nbv.js" as="script"><link rel="prefetch" href="/assets/Facade.html-B8GjRarr.js" as="script"><link rel="prefetch" href="/assets/Flyweight.html-CgU1z3S9.js" as="script"><link rel="prefetch" href="/assets/Proxy.html-DdP5vXcd.js" as="script"><link rel="prefetch" href="/assets/index.html-iZ1D-ktx.js" as="script"><link rel="prefetch" href="/assets/2nd-leg-trap.html-D8HaHXtP.js" as="script"><link rel="prefetch" href="/assets/breakout-test.html-Ck-6H39W.js" as="script"><link rel="prefetch" href="/assets/fake-breakout.html-Zv3bOaBG.js" as="script"><link rel="prefetch" href="/assets/real-breakout.html-BddQl7Ju.js" as="script"><link rel="prefetch" href="/assets/gap-basic.html-CPVQ2IkP.js" as="script"><link rel="prefetch" href="/assets/MACD-beili.html-XkRxq4-h.js" as="script"><link rel="prefetch" href="/assets/atr.html-CKkntLxt.js" as="script"><link rel="prefetch" href="/assets/bolang1.html-BKXokj5f.js" as="script"><link rel="prefetch" href="/assets/bolang2.html-Risup9ge.js" as="script"><link rel="prefetch" href="/assets/ema-entry-and-delete-line.html-CcddW9xN.js" as="script"><link rel="prefetch" href="/assets/ema-reserve.html-BxaT64F9.js" as="script"><link rel="prefetch" href="/assets/ema-stop-loss.html-BSl_XU6y.js" as="script"><link rel="prefetch" href="/assets/last-lesson.html-Bk_OYSmk.js" as="script"><link rel="prefetch" href="/assets/points-and-lines-advanced1.html-DnrxKFS6.js" as="script"><link rel="prefetch" href="/assets/points-and-lines-advanced2.html-QZ0sK-Ql.js" as="script"><link rel="prefetch" href="/assets/points-and-lines-advanced3.html-CDJd3A71.js" as="script"><link rel="prefetch" href="/assets/points-and-lines-advanced4.html-D5MBJ3sT.js" as="script"><link rel="prefetch" href="/assets/signal.html-BLiHVDhr.js" as="script"><link rel="prefetch" href="/assets/stop-loss.html-DbhGJcJ-.js" as="script"><link rel="prefetch" href="/assets/take-profit.html-B_wKIKSC.js" as="script"><link rel="prefetch" href="/assets/cat-scalp-flow.html-rRWtRer5.js" as="script"><link rel="prefetch" href="/assets/ema-flow.html-D-oPEbiN.js" as="script"><link rel="prefetch" href="/assets/yangcongliu.html-BaCDKCzp.js" as="script"><link rel="prefetch" href="/assets/continuation-patterns.html-DKy5IhQh.js" as="script"><link rel="prefetch" href="/assets/first-lesson.html-PL56Ytfo.js" as="script"><link rel="prefetch" href="/assets/k.html-BpIdUspt.js" as="script"><link rel="prefetch" href="/assets/patterns.html-84s_AWhz.js" as="script"><link rel="prefetch" href="/assets/reversal-patterns.html-BGPnBnQb.js" as="script"><link rel="prefetch" href="/assets/fund-risk-management.html-BT4wDcpe.js" as="script"><link rel="prefetch" href="/assets/level-and-cycle-relationship.html-CTdgI6lI.js" as="script"><link rel="prefetch" href="/assets/level-and-cycle.html-BE1sY9xt.js" as="script"><link rel="prefetch" href="/assets/points-and-lines.html-CJWbCRFX.js" as="script"><link rel="prefetch" href="/assets/reversal-and-keypoint.html-CRksd8BJ.js" as="script"><link rel="prefetch" href="/assets/trend-segmentation-and-reversal-definition.html-Ds23_P9T.js" as="script"><link rel="prefetch" href="/assets/use-ema.html-DEHP06Z2.js" as="script"><link rel="prefetch" href="/assets/money-management.html-DvnU9pX_.js" as="script"><link rel="prefetch" href="/assets/points-and-lines.html-BAQPb8rC.js" as="script"><link rel="prefetch" href="/assets/shunshi.html-Dbm9mzS-.js" as="script"><link rel="prefetch" href="/assets/trends-part.html-CCfa3PvE.js" as="script"><link rel="prefetch" href="/assets/trends-stage.html-BotPp9V1.js" as="script"><link rel="prefetch" href="/assets/dao.html-JvrJrxkJ.js" as="script"><link rel="prefetch" href="/assets/maintain-instruction-enhance.html-BN3oUXu6.js" as="script"><link rel="prefetch" href="/assets/maintain-instruction.html-ChAFtjOS.js" as="script"><link rel="prefetch" href="/assets/multi-K.html-BnLfaGYJ.js" as="script"><link rel="prefetch" href="/assets/qushi.html-DeTsRhSq.js" as="script"><link rel="prefetch" href="/assets/relationship.html-1zYZKt9t.js" as="script"><link rel="prefetch" href="/assets/reserve.html-DqMGSADm.js" as="script"><link rel="prefetch" href="/assets/single-K.html-B2fHoOxT.js" as="script"><link rel="prefetch" href="/assets/big-yang-big-yin.html-CIzAaSG4.js" as="script"><link rel="prefetch" href="/assets/dao.html-BMlQp_KW.js" as="script"><link rel="prefetch" href="/assets/identify-trends.html-BqXusiIA.js" as="script"><link rel="prefetch" href="/assets/maintain.html-DZ2sodhK.js" as="script"><link rel="prefetch" href="/assets/mid-yang-mid-yin.html-CKyuAX7C.js" as="script"><link rel="prefetch" href="/assets/multi-k.html-CF0Z7VYv.js" as="script"><link rel="prefetch" href="/assets/qushi-reserve.html-yDl9IvjC.js" as="script"><link rel="prefetch" href="/assets/reserve.html-D-OIRLCo.js" as="script"><link rel="prefetch" href="/assets/JIT.html-nvCR5qpP.js" as="script"><link rel="prefetch" href="/assets/summary.html-DuvMCetj.js" as="script"><link rel="prefetch" href="/assets/24.reflection.html-xHQFamJb.js" as="script"><link rel="prefetch" href="/assets/25.annotation.html-DXt0MpEs.js" as="script"><link rel="prefetch" href="/assets/26.dynamic-proxy.html-CPUtqjuO.js" as="script"><link rel="prefetch" href="/assets/27.lamda.html-wUt4a2z3.js" as="script"><link rel="prefetch" href="/assets/11.container.html-D4TD8a4-.js" as="script"><link rel="prefetch" href="/assets/12.tool.html-FkCZIqNj.js" as="script"><link rel="prefetch" href="/assets/13.HashMap1.html-Cm8M7MUx.js" as="script"><link rel="prefetch" href="/assets/15.LinkedHashMap.html-BY8nUmJe.js" as="script"><link rel="prefetch" href="/assets/16.Iterator.html-BKzBOc-1.js" as="script"><link rel="prefetch" href="/assets/17.exception.html-CDGfyAQM.js" as="script"><link rel="prefetch" href="/assets/18.exception.html-DxSrCyTu.js" as="script"><link rel="prefetch" href="/assets/23.generic.html-B5aF6wHa.js" as="script"><link rel="prefetch" href="/assets/1.program.html-BSvmq4aZ.js" as="script"><link rel="prefetch" href="/assets/10.keyWords.html-3qjQB3lg.js" as="script"><link rel="prefetch" href="/assets/2.åŸºç¡€è¯­æ³•.html-DSciYuzf.js" as="script"><link rel="prefetch" href="/assets/3.å¼•ç”¨.html-BETK7pVP.js" as="script"><link rel="prefetch" href="/assets/4.åŸºæœ¬ç±»å‹.html-CwodbgxJ.js" as="script"><link rel="prefetch" href="/assets/5.bit.html-C_NMMUW1.js" as="script"><link rel="prefetch" href="/assets/6.float.html-BmMYmjFf.js" as="script"><link rel="prefetch" href="/assets/7.character.html-it9MVM3A.js" as="script"><link rel="prefetch" href="/assets/8.String.html-jip8jIOu.js" as="script"><link rel="prefetch" href="/assets/9.class.html-Cm_0GsNo.js" as="script"><link rel="prefetch" href="/assets/19.io.html-BYad4S32.js" as="script"><link rel="prefetch" href="/assets/20.nio.html-DPvl2OgN.js" as="script"><link rel="prefetch" href="/assets/21.é«˜é€Ÿio.html-DPWodU4V.js" as="script"><link rel="prefetch" href="/assets/22.é«˜é€Ÿio.html-Dj9G8fx3.js" as="script"><link rel="prefetch" href="/assets/JMM.html-ByWx3EUk.js" as="script"><link rel="prefetch" href="/assets/thread-safe.html-BP4PS5ma.js" as="script"><link rel="prefetch" href="/assets/thread.html-B_3vsKOF.js" as="script"><link rel="prefetch" href="/assets/ConcurrentHashMap.html-qEoARvT9.js" as="script"><link rel="prefetch" href="/assets/CopyOnWrite.html-CgbUIhNU.js" as="script"><link rel="prefetch" href="/assets/block-wait.html-NIBDtZFQ.js" as="script"><link rel="prefetch" href="/assets/currentContainer.html-BMfl5PgM.js" as="script"><link rel="prefetch" href="/assets/Synchronized.html-B0zqeulo.js" as="script"><link rel="prefetch" href="/assets/deadlock.html-C_LkKfM4.js" as="script"><link rel="prefetch" href="/assets/lock.html-B-bFV__-.js" as="script"><link rel="prefetch" href="/assets/Atomic.html-tPOwavW2.js" as="script"><link rel="prefetch" href="/assets/CAS.html-C_GmR4_T.js" as="script"><link rel="prefetch" href="/assets/LongAdder.html-WUm-khic.js" as="script"><link rel="prefetch" href="/assets/ThreadLocal.html-Czj9my0L.js" as="script"><link rel="prefetch" href="/assets/Latch-Barrier.html-BCGJT8j9.js" as="script"><link rel="prefetch" href="/assets/Semaphore.html-D2Uw4Wc4.js" as="script"><link rel="prefetch" href="/assets/conditionalVariable.html-E8llzmIy.js" as="script"><link rel="prefetch" href="/assets/executor.html-VKIlSDQ9.js" as="script"><link rel="prefetch" href="/assets/thread-interrupt.html-mlJ3hwG5.js" as="script"><link rel="prefetch" href="/assets/thread-state.html-BdNw1hZE.js" as="script"><link rel="prefetch" href="/assets/threadpool.html-BJ7eghhY.js" as="script"><link rel="prefetch" href="/assets/404.html-CrSMDoCP.js" as="script"><link rel="prefetch" href="/assets/index.html-C1_VGnCm.js" as="script"><link rel="prefetch" href="/assets/index.html-DyO_Uz7K.js" as="script"><link rel="prefetch" href="/assets/index.html-wkg6jwik.js" as="script"><link rel="prefetch" href="/assets/index.html-Cz8HeOs1.js" as="script"><link rel="prefetch" href="/assets/index.html-CVP9VjxM.js" as="script"><link rel="prefetch" href="/assets/index.html-DHt_nrTN.js" as="script"><link rel="prefetch" href="/assets/index.html-KEvdrnhL.js" as="script"><link rel="prefetch" href="/assets/index.html-DPLRTNFj.js" as="script"><link rel="prefetch" href="/assets/index.html-Dc_kKjT3.js" as="script"><link rel="prefetch" href="/assets/index.html-DvxgKxeU.js" as="script"><link rel="prefetch" href="/assets/index.html-KlOYtNUE.js" as="script"><link rel="prefetch" href="/assets/index.html-ia8V0Tim.js" as="script"><link rel="prefetch" href="/assets/index.html-Dfb1zgeq.js" as="script"><link rel="prefetch" href="/assets/index.html-BonGRiKT.js" as="script"><link rel="prefetch" href="/assets/index.html-BWQodULr.js" as="script"><link rel="prefetch" href="/assets/index.html-DUkprMl6.js" as="script"><link rel="prefetch" href="/assets/index.html-CI6u-osh.js" as="script"><link rel="prefetch" href="/assets/index.html-DTDYhqAs.js" as="script"><link rel="prefetch" href="/assets/index.html-1wEv5xB_.js" as="script"><link rel="prefetch" href="/assets/index.html-BKZtcO4z.js" as="script"><link rel="prefetch" href="/assets/index.html-CEqHkanq.js" as="script"><link rel="prefetch" href="/assets/index.html-Oc4711hg.js" as="script"><link rel="prefetch" href="/assets/index.html-CpkrwZ9L.js" as="script"><link rel="prefetch" href="/assets/index.html-CcRYo_4b.js" as="script"><link rel="prefetch" href="/assets/index.html-BbqPBV_S.js" as="script"><link rel="prefetch" href="/assets/index.html-BCrUfzlA.js" as="script"><link rel="prefetch" href="/assets/index.html-CP21ZX9H.js" as="script"><link rel="prefetch" href="/assets/index.html-DEo7r56g.js" as="script"><link rel="prefetch" href="/assets/index.html-BeatzJXY.js" as="script"><link rel="prefetch" href="/assets/index.html-DJ9naB49.js" as="script"><link rel="prefetch" href="/assets/index.html-CUNWjMxY.js" as="script"><link rel="prefetch" href="/assets/index.html-DJVRJDSX.js" as="script"><link rel="prefetch" href="/assets/index.html-DefvCejt.js" as="script"><link rel="prefetch" href="/assets/index.html-DkZLhqt1.js" as="script"><link rel="prefetch" href="/assets/index.html-CyFtmwp7.js" as="script"><link rel="prefetch" href="/assets/index.html-CPbNnSZM.js" as="script"><link rel="prefetch" href="/assets/index.html-BgQoLh2o.js" as="script"><link rel="prefetch" href="/assets/index.html-2C4sRoqr.js" as="script"><link rel="prefetch" href="/assets/index.html-DK0coyoV.js" as="script"><link rel="prefetch" href="/assets/index.html-fFb0VoMC.js" as="script"><link rel="prefetch" href="/assets/index.html-BS7DVe8R.js" as="script"><link rel="prefetch" href="/assets/index.html-mjkOPw2h.js" as="script"><link rel="prefetch" href="/assets/index.html-D6WljFMw.js" as="script"><link rel="prefetch" href="/assets/index.html-r-lwUzqm.js" as="script"><link rel="prefetch" href="/assets/index.html-YXBjxrPh.js" as="script"><link rel="prefetch" href="/assets/index.html-BUKOYqQw.js" as="script"><link rel="prefetch" href="/assets/index.html-D_4-4AMG.js" as="script"><link rel="prefetch" href="/assets/index.html-CmIIsqSY.js" as="script"><link rel="prefetch" href="/assets/index.html-OEtGl5vJ.js" as="script"><link rel="prefetch" href="/assets/index.html-BvbZw-cJ.js" as="script"><link rel="prefetch" href="/assets/index.html-bM1w_A11.js" as="script"><link rel="prefetch" href="/assets/index.html-CcBsz58A.js" as="script"><link rel="prefetch" href="/assets/index.html-Dwq8V1P3.js" as="script"><link rel="prefetch" href="/assets/index.html-BNBgD7cC.js" as="script"><link rel="prefetch" href="/assets/index.html-BWpjw1Hw.js" as="script"><link rel="prefetch" href="/assets/index.html-D5Ol_kCe.js" as="script"><link rel="prefetch" href="/assets/index.html-Bpni8QzN.js" as="script"><link rel="prefetch" href="/assets/index.html-DefNCtZp.js" as="script"><link rel="prefetch" href="/assets/index.html-DdN7LZQo.js" as="script"><link rel="prefetch" href="/assets/index.html-6Ha928VL.js" as="script"><link rel="prefetch" href="/assets/index.html-C6u_dmKj.js" as="script"><link rel="prefetch" href="/assets/index.html-DuQ79QSy.js" as="script"><link rel="prefetch" href="/assets/index.html-W3jZSqGl.js" as="script"><link rel="prefetch" href="/assets/index.html-YXwfmNqX.js" as="script"><link rel="prefetch" href="/assets/index.html-DrA4K30U.js" as="script"><link rel="prefetch" href="/assets/index.html-BXHAcasb.js" as="script"><link rel="prefetch" href="/assets/index.html-B-y1VLcx.js" as="script"><link rel="prefetch" href="/assets/index.html-BIcbi9W-.js" as="script"><link rel="prefetch" href="/assets/index.html-CKvfnJML.js" as="script"><link rel="prefetch" href="/assets/index.html-C2trLE3a.js" as="script"><link rel="prefetch" href="/assets/index.html--NZ3QQ4I.js" as="script"><link rel="prefetch" href="/assets/index.html-DrvA5Fta.js" as="script"><link rel="prefetch" href="/assets/index.html-LzWLE648.js" as="script"><link rel="prefetch" href="/assets/index.html-CgWqDM1B.js" as="script"><link rel="prefetch" href="/assets/index.html-B75YL6xI.js" as="script"><link rel="prefetch" href="/assets/index.html-BB8Jubeb.js" as="script"><link rel="prefetch" href="/assets/index.html-BphW_FyU.js" as="script"><link rel="prefetch" href="/assets/index.html-COlhaDR8.js" as="script"><link rel="prefetch" href="/assets/index.html-BnBOM3rN.js" as="script"><link rel="prefetch" href="/assets/index.html-BXF3qiYN.js" as="script"><link rel="prefetch" href="/assets/index.html-BEpsmTDZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DqfS7edW.js" as="script"><link rel="prefetch" href="/assets/index.html-B0I_28XE.js" as="script"><link rel="prefetch" href="/assets/index.html-CmFHVZTU.js" as="script"><link rel="prefetch" href="/assets/index.html-CP5lXtyY.js" as="script"><link rel="prefetch" href="/assets/index.html-B7-eGkYM.js" as="script"><link rel="prefetch" href="/assets/index.html-DTnuX1qP.js" as="script"><link rel="prefetch" href="/assets/index.html-mXG-ZoBO.js" as="script"><link rel="prefetch" href="/assets/index.html-r-53fO5K.js" as="script"><link rel="prefetch" href="/assets/index.html-DokHI3O5.js" as="script"><link rel="prefetch" href="/assets/index.html-CMnBk8bs.js" as="script"><link rel="prefetch" href="/assets/index.html-3oWAz8NA.js" as="script"><link rel="prefetch" href="/assets/index.html-C4_zmIHB.js" as="script"><link rel="prefetch" href="/assets/index.html-DWnHcxyE.js" as="script"><link rel="prefetch" href="/assets/index.html-CbQpRtvl.js" as="script"><link rel="prefetch" href="/assets/index.html-Bw6oS3Np.js" as="script"><link rel="prefetch" href="/assets/index.html-qnaqU5lE.js" as="script"><link rel="prefetch" href="/assets/index.html-CdUrwACU.js" as="script"><link rel="prefetch" href="/assets/index.html-DppUINO5.js" as="script"><link rel="prefetch" href="/assets/index.html-C1qh7XDu.js" as="script"><link rel="prefetch" href="/assets/index.html-C5mhfPdu.js" as="script"><link rel="prefetch" href="/assets/index.html-DUiT1BRl.js" as="script"><link rel="prefetch" href="/assets/index.html-CDavKeqV.js" as="script"><link rel="prefetch" href="/assets/index.html-Dl77N8xD.js" as="script"><link rel="prefetch" href="/assets/index.html-fxa4ZNun.js" as="script"><link rel="prefetch" href="/assets/auto-BUYG9-ss.js" as="script"><link rel="prefetch" href="/assets/index-DizPPLlo.js" as="script"><link rel="prefetch" href="/assets/flowchart-G1WAoCnn.js" as="script"><link rel="prefetch" href="/assets/index-DtWMYcbt.js" as="script"><link rel="prefetch" href="/assets/index-DMDrkyre.js" as="script"><link rel="prefetch" href="/assets/index-BPAdBlYL.js" as="script"><link rel="prefetch" href="/assets/mermaid.esm.min-Bt8cH-H3.js" as="script"><link rel="prefetch" href="/assets/vue-repl-BMt7_d7Z.js" as="script"><link rel="prefetch" href="/assets/codemirror-editor-DMzSXSsR.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-CKV1Bsxh.js" as="script"><link rel="prefetch" href="/assets/giscus-BACEvYzX.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/logo.png" alt><!----><span class="vp-site-name hide-in-pad">Weiser</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="home" sizing="height" height="1em"></iconify-icon><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/home.html" aria-label="é¡¹ç›®ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="home" sizing="height" height="1em"></iconify-icon><!--]-->é¡¹ç›®ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="è®¡ç®—æœºåŸºç¡€"><!--[--><iconify-icon class="vp-icon" icon="rank" sizing="height" height="1em"></iconify-icon>è®¡ç®—æœºåŸºç¡€<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/basics/algorithm/" aria-label="ç®—æ³•"><!--[--><iconify-icon class="vp-icon" icon="rank" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->ç®—æ³•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/basics/MySQL/" aria-label="MySQLæ•°æ®åº“"><!--[--><iconify-icon class="vp-icon" icon="mysql" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->MySQLæ•°æ®åº“<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/basics/design-patterns/" aria-label="è®¾è®¡æ¨¡å¼"><!--[--><iconify-icon class="vp-icon" icon="repair" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->è®¾è®¡æ¨¡å¼<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/basics/OOP/OOP.html" aria-label="é¢å‘å¯¹è±¡"><!--[--><iconify-icon class="vp-icon" icon="people" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->é¢å‘å¯¹è±¡<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/basics/design-principles/S.html" aria-label="è®¾è®¡æ€æƒ³å’ŒåŸåˆ™"><!--[--><iconify-icon class="vp-icon" icon="people" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->è®¾è®¡æ€æƒ³å’ŒåŸåˆ™<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/basics/distribute/CAP_BASE.html" aria-label="åˆ†å¸ƒå¼"><!--[--><iconify-icon class="vp-icon" icon="snow" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->åˆ†å¸ƒå¼<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="è¯­è¨€"><!--[--><iconify-icon class="vp-icon" icon="language" sizing="height" height="1em"></iconify-icon>è¯­è¨€<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/language/Java/" aria-label="Java"><!--[--><iconify-icon class="vp-icon" icon="java" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Java<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å·¥å…·"><!--[--><iconify-icon class="vp-icon" icon="tool" sizing="height" height="1em"></iconify-icon>å·¥å…·<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tools/git.html" aria-label="git"><!--[--><iconify-icon class="vp-icon" icon="git" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->git<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tools/linux%E5%91%BD%E4%BB%A4.html" aria-label="linuxå‘½ä»¤"><!--[--><iconify-icon class="vp-icon" icon="linux" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->linuxå‘½ä»¤<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é¡¹ç›®"><!--[--><iconify-icon class="vp-icon" icon="strong" sizing="height" height="1em"></iconify-icon>é¡¹ç›®<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/project/lottery/lottery-design-patterns.html" aria-label="lotteryæŠ½å¥–ç³»ç»Ÿ"><!--[--><iconify-icon class="vp-icon" icon="group" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->lotteryæŠ½å¥–ç³»ç»Ÿ<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é¢å‘æ‹›è˜"><!--[--><iconify-icon class="vp-icon" icon="strong" sizing="height" height="1em"></iconify-icon>é¢å‘æ‹›è˜<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/recruitment/campus/tipsFromBYRForum.html" aria-label="æ ¡æ‹›"><!--[--><iconify-icon class="vp-icon" icon="group" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->æ ¡æ‹›<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/" aria-label="ç¤¾æ‹›"><!--[--><iconify-icon class="vp-icon" icon="mysql" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->ç¤¾æ‹›<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="äº¤æ˜“"><!--[--><iconify-icon class="vp-icon" icon="money" sizing="height" height="1em"></iconify-icon>äº¤æ˜“<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/trade/" aria-label="äº¤æ˜“åŸºç¡€"><!--[--><iconify-icon class="vp-icon" icon="group" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->äº¤æ˜“åŸºç¡€<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å…³äº"><!--[--><iconify-icon class="vp-icon" icon="info" sizing="height" height="1em"></iconify-icon>å…³äº<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about/cv.html" aria-label="ç®€å†"><!--[--><iconify-icon class="vp-icon" icon="blog" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->ç®€å†<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about/guide.html" aria-label="å…³äºæœ¬ç«™"><!--[--><iconify-icon class="vp-icon" icon="info" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->å…³äºæœ¬ç«™<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-appearance-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-appearance-dropdown"><!----></div></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="creative" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">ç®—æ³•</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="mysql" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="repair" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">é¢å‘å¯¹è±¡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="repair" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">è®¾è®¡åŸåˆ™å’Œæ€æƒ³</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><iconify-icon class="vp-icon" icon="repair" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">è®¾è®¡æ¨¡å¼</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/basics/design-patterns/" aria-label="SOLIDåŸåˆ™"><!---->SOLIDåŸåˆ™<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">åˆ›å»ºè€…æ¨¡å¼</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/basics/design-patterns/creational-patterns/" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/basics/design-patterns/creational-patterns/singleton.html" aria-label="å•ä¾‹æ¨¡å¼"><!---->å•ä¾‹æ¨¡å¼<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/basics/design-patterns/creational-patterns/factory-method.html" aria-label="å·¥å‚æ–¹æ³•"><!---->å·¥å‚æ–¹æ³•<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/basics/design-patterns/creational-patterns/builder.html" aria-label="å»ºé€ è€…æ¨¡å¼ï¼ˆç”Ÿæˆå™¨æ¨¡å¼ï¼‰"><!---->å»ºé€ è€…æ¨¡å¼ï¼ˆç”Ÿæˆå™¨æ¨¡å¼ï¼‰<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/basics/design-patterns/creational-patterns/prototype.html" aria-label="åŸå‹æ¨¡å¼"><!---->åŸå‹æ¨¡å¼<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ç»“æ„å‹æ¨¡å¼</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">è¡Œä¸ºå‹æ¨¡å¼</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->å•ä¾‹æ¨¡å¼</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/xwzbupt" target="_blank" rel="noopener noreferrer">Weiser</a></span><span property="author" content="Weiser"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/6/21</span><meta property="datePublished" content="2025-06-21T15:03:37.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 39 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT39M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 11708 å­—</span><meta property="wordCount" content="11708"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="å•ä¾‹æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#å•ä¾‹æ¨¡å¼"><span><strong>å•ä¾‹æ¨¡å¼</strong></span></a></h1><blockquote><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿ</p><p>å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ</p><p>å•ä¾‹ä¸é™æ€ç±»çš„åŒºåˆ«ï¼Ÿ</p><p>æœ‰ä½•æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Ÿ</p></blockquote><h2 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹"><span><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿ</strong></span></a></h2><p><strong>å•ä¾‹è®¾è®¡æ¨¡å¼</strong>ï¼ˆSingleton Design Patternï¼‰ç†è§£èµ·æ¥éå¸¸ç®€å•ã€‚ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–è€…å®ä¾‹ï¼‰ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«ä½œå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°å•ä¾‹æ¨¡å¼ã€‚</p><p>å¯¹äºå•ä¾‹çš„æ¦‚å¿µï¼Œæˆ‘è§‰å¾—æ²¡å¿…è¦è§£é‡Šå¤ªå¤šï¼Œä½ ä¸€çœ‹å°±èƒ½æ˜ç™½ã€‚æˆ‘ä»¬é‡ç‚¹çœ‹ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼ï¼Ÿå®ƒèƒ½è§£å†³å“ªäº›é—®é¢˜ï¼Ÿæ¥ä¸‹æ¥æˆ‘é€šè¿‡ä¸¤ä¸ªå®æˆ˜æ¡ˆä¾‹æ¥è®²è§£ã€‚</p><h3 id="å®æˆ˜æ¡ˆä¾‹ä¸€-å¤„ç†èµ„æºè®¿é—®å†²çª" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜æ¡ˆä¾‹ä¸€-å¤„ç†èµ„æºè®¿é—®å†²çª"><span><strong>å®æˆ˜æ¡ˆä¾‹ä¸€ï¼šå¤„ç†èµ„æºè®¿é—®å†²çª</strong></span></a></h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªä¾‹å­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰å®ç°äº†ä¸€ä¸ªå¾€æ–‡ä»¶ä¸­æ‰“å°æ—¥å¿—çš„ Logger ç±»ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> FileWriter</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/Users/wangzheng/log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    writer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> FileWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(mesasge);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Loggerç±»çš„åº”ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> UserController</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> logger </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> login</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(username </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot; logined!&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> OrderController</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> logger </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">OrderVo</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Created an order: &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>çœ‹å®Œä»£ç ä¹‹åï¼Œå…ˆåˆ«ç€æ€¥çœ‹æˆ‘ä¸‹é¢çš„è®²è§£ï¼Œä½ å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ï¼Œè¿™æ®µä»£ç å­˜åœ¨ä»€ä¹ˆé—®é¢˜ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ‰€æœ‰çš„æ—¥å¿—éƒ½å†™å…¥åˆ°åŒä¸€ä¸ªæ–‡ä»¶ /Users/wangzheng/log.txt ä¸­ã€‚åœ¨ UserController å’Œ OrderController ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«åˆ›å»ºä¸¤ä¸ª Logger å¯¹è±¡ã€‚åœ¨ Web å®¹å™¨çš„ Servlet å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸¤ä¸ª Servlet çº¿ç¨‹åŒæ—¶åˆ†åˆ«æ‰§è¡Œ login() å’Œ create() ä¸¤ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”åŒæ—¶å†™æ—¥å¿—åˆ° log.txt æ–‡ä»¶ä¸­ï¼Œé‚£å°±æœ‰å¯èƒ½å­˜åœ¨æ—¥å¿—ä¿¡æ¯äº’ç›¸è¦†ç›–çš„æƒ…å†µã€‚</p><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°äº’ç›¸è¦†ç›–å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç±»æ¯”ç€ç†è§£ã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ç»™åŒä¸€ä¸ªå…±äº«å˜é‡åŠ  1ï¼Œå› ä¸ºå…±äº«å˜é‡æ˜¯ç«äº‰èµ„æºï¼Œæ‰€ä»¥ï¼Œå…±äº«å˜é‡æœ€åçš„ç»“æœæœ‰å¯èƒ½å¹¶ä¸æ˜¯åŠ äº† 2ï¼Œè€Œæ˜¯åªåŠ äº† 1ã€‚åŒç†ï¼Œè¿™é‡Œçš„ log.txt æ–‡ä»¶ä¹Ÿæ˜¯ç«äº‰èµ„æºï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¾€é‡Œé¢å†™æ•°æ®ï¼Œå°±æœ‰å¯èƒ½å­˜åœ¨äº’ç›¸è¦†ç›–çš„æƒ…å†µã€‚</p><figure><img src="https://personal-site-pictures.oss-cn-beijing.aliyuncs.com/img/å•ä¾‹1.jpg" alt="å•ä¾‹1" tabindex="0" loading="lazy"><figcaption>å•ä¾‹1</figcaption></figure><p>é‚£å¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬æœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯é€šè¿‡åŠ é”çš„æ–¹å¼ï¼šç»™ log() å‡½æ•°åŠ äº’æ–¥é”ï¼ˆJava ä¸­å¯ä»¥é€šè¿‡ synchronized çš„å…³é”®å­—ï¼‰ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨æ‰§è¡Œ log() å‡½æ•°ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> FileWriter</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/Users/wangzheng/log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    writer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> FileWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    synchronized</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">      writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(mesasge);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>ä¸è¿‡ï¼Œä½ ä»”ç»†æƒ³æƒ³ï¼Œè¿™çœŸçš„èƒ½è§£å†³å¤šçº¿ç¨‹å†™å…¥æ—¥å¿—æ—¶äº’ç›¸è¦†ç›–çš„é—®é¢˜å—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œè¿™ç§é”æ˜¯ä¸€ä¸ªå¯¹è±¡çº§åˆ«çš„é”ï¼Œä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„çº¿ç¨‹ä¸‹åŒæ—¶è°ƒç”¨ log() å‡½æ•°ï¼Œä¼šè¢«å¼ºåˆ¶è¦æ±‚é¡ºåºæ‰§è¡Œã€‚ä½†æ˜¯ï¼Œä¸åŒçš„å¯¹è±¡ä¹‹é—´å¹¶ä¸å…±äº«åŒä¸€æŠŠé”ã€‚åœ¨ä¸åŒçš„çº¿ç¨‹ä¸‹ï¼Œé€šè¿‡ä¸åŒçš„å¯¹è±¡è°ƒç”¨æ‰§è¡Œ log() å‡½æ•°ï¼Œé”å¹¶ä¸ä¼šèµ·ä½œç”¨ï¼Œä»ç„¶æœ‰å¯èƒ½å­˜åœ¨å†™å…¥æ—¥å¿—äº’ç›¸è¦†ç›–çš„é—®é¢˜ã€‚</p><figure><img src="https://personal-site-pictures.oss-cn-beijing.aliyuncs.com/img/å•ä¾‹2.jpg" alt="å•ä¾‹2" tabindex="0" loading="lazy"><figcaption>å•ä¾‹2</figcaption></figure><p>æˆ‘è¿™é‡Œç¨å¾®è¡¥å……ä¸€ä¸‹ï¼Œåœ¨åˆšåˆšçš„è®²è§£å’Œç»™å‡ºçš„ä»£ç ä¸­ï¼Œæˆ‘æ•…æ„â€œéšç’â€äº†ä¸€ä¸ªäº‹å®ï¼šæˆ‘ä»¬ç»™ log() å‡½æ•°åŠ ä¸åŠ å¯¹è±¡çº§åˆ«çš„é”ï¼Œå…¶å®éƒ½æ²¡æœ‰å…³ç³»ã€‚å› ä¸º FileWriter æœ¬èº«å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„å†…éƒ¨å®ç°ä¸­æœ¬èº«å°±åŠ äº†å¯¹è±¡çº§åˆ«çš„é”ï¼Œå› æ­¤ï¼Œåœ¨åœ¨å¤–å±‚è°ƒç”¨ write() å‡½æ•°çš„æ—¶å€™ï¼Œå†åŠ å¯¹è±¡çº§åˆ«çš„é”å®é™…ä¸Šæ˜¯å¤šæ­¤ä¸€ä¸¾ã€‚å› ä¸ºä¸åŒçš„ Logger å¯¹è±¡ä¸å…±äº« FileWriter å¯¹è±¡ï¼Œæ‰€ä»¥ï¼ŒFileWriter å¯¹è±¡çº§åˆ«çš„é”ä¹Ÿè§£å†³ä¸äº†æ•°æ®å†™å…¥äº’ç›¸è¦†ç›–çš„é—®é¢˜ã€‚</p><p>é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå®é™…ä¸Šï¼Œè¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿä¸éš¾ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå¯¹è±¡çº§åˆ«çš„é”ï¼Œæ¢æˆç±»çº§åˆ«çš„é”å°±å¯ä»¥äº†ã€‚è®©æ‰€æœ‰çš„å¯¹è±¡éƒ½å…±äº«åŒä¸€æŠŠé”ã€‚è¿™æ ·å°±é¿å…äº†ä¸åŒå¯¹è±¡ä¹‹é—´åŒæ—¶è°ƒç”¨ log() å‡½æ•°ï¼Œè€Œå¯¼è‡´çš„æ—¥å¿—è¦†ç›–é—®é¢˜ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> FileWriter</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/Users/wangzheng/log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    writer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> FileWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    synchronized</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ç±»çº§åˆ«çš„é”</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">      writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(mesasge);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>é™¤äº†ä½¿ç”¨ç±»çº§åˆ«é”ä¹‹å¤–ï¼Œå®é™…ä¸Šï¼Œè§£å†³èµ„æºç«äº‰é—®é¢˜çš„åŠæ³•è¿˜æœ‰å¾ˆå¤šï¼Œåˆ†å¸ƒå¼é”æ˜¯æœ€å¸¸å¬åˆ°çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ä¸è¿‡ï¼Œå®ç°ä¸€ä¸ªå®‰å…¨å¯é ã€æ—  bugã€é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼é”ï¼Œå¹¶ä¸æ˜¯ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¹¶å‘é˜Ÿåˆ—ï¼ˆæ¯”å¦‚ Java ä¸­çš„ BlockingQueueï¼‰ä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶å¾€å¹¶å‘é˜Ÿåˆ—é‡Œå†™æ—¥å¿—ï¼Œä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹è´Ÿè´£å°†å¹¶å‘é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œå†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼å®ç°èµ·æ¥ä¹Ÿç¨å¾®æœ‰ç‚¹å¤æ‚ã€‚</p><p>ç›¸å¯¹äºè¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œå•ä¾‹æ¨¡å¼çš„è§£å†³æ€è·¯å°±ç®€å•ä¸€äº›äº†ã€‚å•ä¾‹æ¨¡å¼ç›¸å¯¹äºä¹‹å‰ç±»çº§åˆ«é”çš„å¥½å¤„æ˜¯ï¼Œä¸ç”¨åˆ›å»ºé‚£ä¹ˆå¤š Logger å¯¹è±¡ï¼Œä¸€æ–¹é¢èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå¦ä¸€æ–¹é¢èŠ‚çœç³»ç»Ÿæ–‡ä»¶å¥æŸ„ï¼ˆå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œæ–‡ä»¶å¥æŸ„ä¹Ÿæ˜¯ä¸€ç§èµ„æºï¼Œä¸èƒ½éšä¾¿æµªè´¹ï¼‰ã€‚</p><p>æˆ‘ä»¬å°† Logger è®¾è®¡æˆä¸€ä¸ªå•ä¾‹ç±»ï¼Œç¨‹åºä¸­åªå…è®¸åˆ›å»ºä¸€ä¸ª Logger å¯¹è±¡ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å…±äº«ä½¿ç”¨çš„è¿™ä¸€ä¸ª Logger å¯¹è±¡ï¼Œå…±äº«ä¸€ä¸ª FileWriter å¯¹è±¡ï¼Œè€Œ FileWriter æœ¬èº«æ˜¯å¯¹è±¡çº§åˆ«çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±é¿å…äº†å¤šçº¿ç¨‹æƒ…å†µä¸‹å†™æ—¥å¿—ä¼šäº’ç›¸è¦†ç›–çš„é—®é¢˜ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬å®ç°äº† Logger å•ä¾‹ç±»ã€‚å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> FileWriter</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/Users/wangzheng/log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    writer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> FileWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//trueè¡¨ç¤ºè¿½åŠ å†™å…¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    writer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(mesasge);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Loggerç±»çš„åº”ç”¨ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> UserController</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> login</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(username </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot; logined!&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> OrderController</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> logger </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">OrderVo</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Created a order: &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><h3 id="å®æˆ˜æ¡ˆä¾‹äºŒ-è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜æ¡ˆä¾‹äºŒ-è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»"><span><strong>å®æˆ˜æ¡ˆä¾‹äºŒï¼šè¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»</strong></span></a></h3><p>ä»ä¸šåŠ¡æ¦‚å¿µä¸Šï¼Œå¦‚æœæœ‰äº›æ•°æ®åœ¨ç³»ç»Ÿä¸­åªåº”ä¿å­˜ä¸€ä»½ï¼Œé‚£å°±æ¯”è¾ƒé€‚åˆè®¾è®¡ä¸ºå•ä¾‹ç±»ã€‚</p><p>æ¯”å¦‚ï¼Œé…ç½®ä¿¡æ¯ç±»ã€‚åœ¨ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå½“é…ç½®æ–‡ä»¶è¢«åŠ è½½åˆ°å†…å­˜ä¹‹åï¼Œä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œä¹Ÿç†æ‰€åº”å½“åªæœ‰ä¸€ä»½ã€‚</p><p>å†æ¯”å¦‚ï¼Œå”¯ä¸€é€’å¢ ID å·ç ç”Ÿæˆå™¨ï¼ˆç¬¬ 34 è®²ä¸­æˆ‘ä»¬è®²çš„æ˜¯å”¯ä¸€ ID ç”Ÿæˆå™¨ï¼Œè¿™é‡Œè®²çš„æ˜¯å”¯ä¸€é€’å¢ ID ç”Ÿæˆå™¨ï¼‰ï¼Œå¦‚æœç¨‹åºä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼Œé‚£å°±ä¼šå­˜åœ¨ç”Ÿæˆé‡å¤ ID çš„æƒ…å†µï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥å°† ID ç”Ÿæˆå™¨ç±»è®¾è®¡ä¸ºå•ä¾‹ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> java.util.concurrent.atomic.AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // AtomicLongæ˜¯ä¸€ä¸ªJavaå¹¶å‘åº“ä¸­æä¾›çš„ä¸€ä¸ªåŸå­å˜é‡ç±»å‹,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // å®ƒå°†ä¸€äº›çº¿ç¨‹ä¸å®‰å…¨éœ€è¦åŠ é”çš„å¤åˆæ“ä½œå°è£…ä¸ºäº†çº¿ç¨‹å®‰å…¨çš„åŸå­æ“ä½œï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // æ¯”å¦‚ä¸‹é¢ä¼šç”¨åˆ°çš„incrementAndGet().</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AtomicLong</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrementAndGet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// IdGeneratorä½¿ç”¨ä¸¾ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…ä¸Šï¼Œä»Šå¤©è®²åˆ°çš„ä¸¤ä¸ªä»£ç å®ä¾‹ï¼ˆLoggerã€IdGeneratorï¼‰ï¼Œè®¾è®¡çš„éƒ½å¹¶ä¸ä¼˜é›…ï¼Œè¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚è‡³äºæœ‰ä»€ä¹ˆé—®é¢˜ä»¥åŠå¦‚ä½•æ”¹é€ ï¼Œä»Šå¤©æˆ‘æš‚æ—¶å–ä¸ªå…³å­ï¼Œä¸‹ä¸€èŠ‚è¯¾æˆ‘ä¼šè¯¦ç»†è®²è§£ã€‚</p><h2 id="ä»£ç ç¤ºä¾‹-æ‰‹å†™å•ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹-æ‰‹å†™å•ä¾‹"><span><strong>ä»£ç ç¤ºä¾‹ï¼ˆæ‰‹å†™å•ä¾‹ï¼‰</strong></span></a></h2><p>å°½ç®¡ä»‹ç»å¦‚ä½•å®ç°ä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„æ–‡ç« å·²ç»æœ‰å¾ˆå¤šäº†ï¼Œä½†ä¸ºäº†ä¿è¯å†…å®¹çš„å®Œæ•´æ€§ï¼Œæˆ‘è¿™é‡Œè¿˜æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹å‡ ç§ç»å…¸å®ç°æ–¹å¼ã€‚æ¦‚æ‹¬èµ·æ¥ï¼Œè¦å®ç°ä¸€ä¸ªå•ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨çš„ç‚¹æ— å¤–ä¹ä¸‹é¢å‡ ä¸ªï¼š</p><p>æ„é€ å‡½æ•°éœ€è¦æ˜¯ private è®¿é—®æƒé™çš„ï¼Œè¿™æ ·æ‰èƒ½é¿å…å¤–éƒ¨é€šè¿‡ new åˆ›å»ºå®ä¾‹ï¼›</p><p>è€ƒè™‘å¯¹è±¡åˆ›å»ºæ—¶çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›</p><p>è€ƒè™‘æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼›</p><p>è€ƒè™‘ getInstance() æ€§èƒ½æ˜¯å¦é«˜ï¼ˆæ˜¯å¦åŠ é”ï¼‰ã€‚</p><p>å¦‚æœä½ å¯¹è¿™å—å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œä½ å¯ä»¥å½“ä½œå¤ä¹ ã€‚æ³¨æ„ï¼Œä¸‹é¢çš„å‡ ç§å•ä¾‹å®ç°æ–¹å¼æ˜¯é’ˆå¯¹ Java è¯­è¨€è¯­æ³•çš„ï¼Œå¦‚æœä½ ç†Ÿæ‚‰çš„æ˜¯å…¶ä»–è¯­è¨€ï¼Œä¸å¦¨å¯¹æ¯” Java çš„è¿™å‡ ç§å®ç°æ–¹å¼ï¼Œè‡ªå·±è¯•ç€æ€»ç»“ä¸€ä¸‹ï¼Œåˆ©ç”¨ä½ ç†Ÿæ‚‰çš„è¯­è¨€ï¼Œè¯¥å¦‚ä½•å®ç°ã€‚</p><h3 id="é¥¿æ±‰-çº¿ç¨‹å®‰å…¨" tabindex="-1"><a class="header-anchor" href="#é¥¿æ±‰-çº¿ç¨‹å®‰å…¨"><span><strong>é¥¿æ±‰ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</strong></span></a></h3><p>ç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–å®ä¾‹ï¼Œé¿å…äº†å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œå¤©ç„¶çº¿ç¨‹å®‰å…¨ã€‚</p><p>è§£é‡Šï¼šç±»åŠ è½½çš„æ–¹å¼æ˜¯æŒ‰éœ€åŠ è½½ï¼Œä¸”åªåŠ è½½ä¸€æ¬¡ã€‚å› æ­¤ï¼Œåœ¨ä¸Šè¿°å•ä¾‹ç±»è¢«åŠ è½½æ—¶ï¼Œå°±ä¼šå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å¹¶äº¤ç»™è‡ªå·±çš„å¼•ç”¨ï¼Œä¾›ç³»ç»Ÿä½¿ç”¨ï¼Œå³åœ¨çº¿ç¨‹è®¿é—®å•ä¾‹å¯¹è±¡ä¹‹å‰ï¼Œå…¶å°±å·²ç»åˆ›å»ºå¥½äº†ã€‚çº¿ç¨‹æ¯æ¬¡éƒ½åªèƒ½æ‹¿åˆ°è¿™ä¸ªå”¯ä¸€çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œé¥¿æ±‰å¼å•ä¾‹å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton  </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> singleton;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>æœ‰äººè§‰å¾—è¿™ç§å®ç°æ–¹å¼ä¸å¥½ï¼Œå› ä¸ºä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œå¦‚æœå®ä¾‹å ç”¨èµ„æºå¤šï¼ˆæ¯”å¦‚å ç”¨å†…å­˜å¤šï¼‰æˆ–åˆå§‹åŒ–è€—æ—¶é•¿ï¼ˆæ¯”å¦‚éœ€è¦åŠ è½½å„ç§é…ç½®æ–‡ä»¶ï¼‰ï¼Œæå‰åˆå§‹åŒ–å®ä¾‹æ˜¯ä¸€ç§æµªè´¹èµ„æºçš„è¡Œä¸ºã€‚æœ€å¥½çš„æ–¹æ³•åº”è¯¥åœ¨ç”¨åˆ°çš„æ—¶å€™å†å»åˆå§‹åŒ–ã€‚ä¸è¿‡ï¼Œæˆ‘ä¸ªäººå¹¶ä¸è®¤åŒè¿™æ ·çš„è§‚ç‚¹ã€‚</p><p>å¦‚æœåˆå§‹åŒ–è€—æ—¶é•¿ï¼Œé‚£æˆ‘ä»¬æœ€å¥½ä¸è¦ç­‰åˆ°çœŸæ­£è¦ç”¨å®ƒçš„æ—¶å€™ï¼Œæ‰å»æ‰§è¡Œè¿™ä¸ªè€—æ—¶é•¿çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè¿™ä¼šå½±å“åˆ°ç³»ç»Ÿçš„æ€§èƒ½ï¼ˆæ¯”å¦‚ï¼Œåœ¨å“åº”å®¢æˆ·ç«¯æ¥å£è¯·æ±‚çš„æ—¶å€™ï¼Œåšè¿™ä¸ªåˆå§‹åŒ–æ“ä½œï¼Œä¼šå¯¼è‡´æ­¤è¯·æ±‚çš„å“åº”æ—¶é—´å˜é•¿ï¼Œç”šè‡³è¶…æ—¶ï¼‰ã€‚é‡‡ç”¨é¥¿æ±‰å¼å®ç°æ–¹å¼ï¼Œå°†è€—æ—¶çš„åˆå§‹åŒ–æ“ä½œï¼Œæå‰åˆ°ç¨‹åºå¯åŠ¨çš„æ—¶å€™å®Œæˆï¼Œè¿™æ ·å°±èƒ½é¿å…åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œå†å»åˆå§‹åŒ–å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>å¦‚æœå®ä¾‹å ç”¨èµ„æºå¤šï¼ŒæŒ‰ç…§ fail-fast çš„è®¾è®¡åŸåˆ™ï¼ˆæœ‰é—®é¢˜åŠæ—©æš´éœ²ï¼‰ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¸Œæœ›åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±å°†è¿™ä¸ªå®ä¾‹åˆå§‹åŒ–å¥½ã€‚å¦‚æœèµ„æºä¸å¤Ÿï¼Œå°±ä¼šåœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™è§¦å‘æŠ¥é”™ï¼ˆæ¯”å¦‚ Java ä¸­çš„ PermGen Space OOMï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³å»ä¿®å¤ã€‚è¿™æ ·ä¹Ÿèƒ½é¿å…åœ¨ç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œçªç„¶å› ä¸ºåˆå§‹åŒ–è¿™ä¸ªå®ä¾‹å ç”¨èµ„æºè¿‡å¤šï¼Œå¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œå½±å“ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</p><h3 id="æ‡’æ±‰-çº¿ç¨‹ä¸å®‰å…¨" tabindex="-1"><a class="header-anchor" href="#æ‡’æ±‰-çº¿ç¨‹ä¸å®‰å…¨"><span><strong>æ‡’æ±‰ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</strong></span></a></h3><p>å®ä¾‹å¯¹è±¡åœ¨ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ‰çœŸæ­£æ„å»ºçš„ï¼Œè€Œä¸æ˜¯ç¨‹åºä¸€å¯åŠ¨å°±ä¼šè‡ªåŠ¨æ„å»ºã€‚æ‰€ä»¥è¿™ç§æ»åæ„å»ºçš„æ–¹å¼å°±å«åš<strong>å»¶è¿ŸåŠ è½½</strong>ã€‚è¿™ç§å®ç°æœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸æ”¯æŒå¤šçº¿ç¨‹ã€‚å› ä¸ºæ²¡æœ‰åŠ é” synchronizedï¼Œå¤šçº¿ç¨‹åœºæ™¯ä¸‹ä¸è¦ä½¿ç”¨ï¼Œå› ä¸ºå¯èƒ½ä¼šäº§ç”Ÿå¤šä¸ªå¯¹è±¡ï¼Œä¸å†æ˜¯å•ä¾‹ã€‚</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   //public static synchronized Lazy getInstance(){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> singleton;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h3 id="æ‡’æ±‰-åŒæ­¥é”-çº¿ç¨‹å®‰å…¨" tabindex="-1"><a class="header-anchor" href="#æ‡’æ±‰-åŒæ­¥é”-çº¿ç¨‹å®‰å…¨"><span><strong>æ‡’æ±‰ï¼ˆåŒæ­¥é”ï¼Œçº¿ç¨‹å®‰å…¨ï¼‰</strong></span></a></h3><p>å’Œä¸Šé¢å®ç°ä¸Šå”¯ä¸€ä¸åŒæ˜¯ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼šè·å–å®ä¾‹çš„<code>getSingleton()</code>æ–¹æ³•ä¸ŠåŠ äº†åŒæ­¥é”ã€‚ä¿è¯äº†å¤šçº¿ç¨‹åœºæ™¯ä¸‹çš„å•ä¾‹ã€‚<strong>ä½†æ˜¯ç¨‹åºæ•ˆç‡ä¼šæœ‰æ‰€æŠ˜æŸã€‚</strong></p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getSingleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> singleton;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>ä¸è¿‡æ‡’æ±‰å¼çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬ç»™ getInstance() è¿™ä¸ªæ–¹æ³•åŠ äº†ä¸€æŠŠå¤§é”ï¼ˆsynchronzedï¼‰ï¼Œå¯¼è‡´è¿™ä¸ªå‡½æ•°çš„å¹¶å‘åº¦å¾ˆä½ã€‚é‡åŒ–ä¸€ä¸‹çš„è¯ï¼Œå¹¶å‘åº¦æ˜¯ 1ï¼Œä¹Ÿå°±ç›¸å½“äºä¸²è¡Œæ“ä½œäº†ã€‚è€Œè¿™ä¸ªå‡½æ•°æ˜¯åœ¨å•ä¾‹ä½¿ç”¨æœŸé—´ï¼Œä¸€ç›´ä¼šè¢«è°ƒç”¨ã€‚å¦‚æœè¿™ä¸ªå•ä¾‹ç±»å¶å°”ä¼šè¢«ç”¨åˆ°ï¼Œé‚£è¿™ç§å®ç°æ–¹å¼è¿˜å¯ä»¥æ¥å—ã€‚<strong>ä½†æ˜¯ï¼Œå¦‚æœé¢‘ç¹åœ°ç”¨åˆ°ï¼Œé‚£é¢‘ç¹åŠ é”ã€é‡Šæ”¾é”åŠå¹¶å‘åº¦ä½ç­‰é—®é¢˜ï¼Œä¼šå¯¼è‡´æ€§èƒ½ç“¶é¢ˆï¼Œè¿™ç§å®ç°æ–¹å¼å°±ä¸å¯å–äº†ã€‚</strong></p><h3 id="åŒé‡æ ¡éªŒé”-çº¿ç¨‹å®‰å…¨-æ•ˆç‡é«˜" tabindex="-1"><a class="header-anchor" href="#åŒé‡æ ¡éªŒé”-çº¿ç¨‹å®‰å…¨-æ•ˆç‡é«˜"><span><strong>åŒé‡æ ¡éªŒé”ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡é«˜ï¼‰</strong></span></a></h3><p>é¥¿æ±‰å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œæ‡’æ±‰å¼æœ‰æ€§èƒ½é—®é¢˜ï¼Œä¸æ”¯æŒé«˜å¹¶å‘ã€‚é‚£æˆ‘ä»¬å†æ¥çœ‹ä¸€ç§æ—¢æ”¯æŒå»¶è¿ŸåŠ è½½ã€åˆæ”¯æŒé«˜å¹¶å‘çš„å•ä¾‹å®ç°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åŒé‡æ£€æµ‹å®ç°æ–¹å¼ã€‚</p><p>åœ¨è¿™ç§å®ç°æ–¹å¼ä¸­ï¼Œåªè¦ instance è¢«åˆ›å»ºä¹‹åï¼Œå³ä¾¿å†è°ƒç”¨ getInstance() å‡½æ•°ä¹Ÿä¸ä¼šå†è¿›å…¥åˆ°åŠ é”é€»è¾‘ä¸­äº†ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹å¼è§£å†³äº†æ‡’æ±‰å¼å¹¶å‘åº¦ä½çš„é—®é¢˜ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> volatile</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getSingleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            synchronized</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æ­¤å¤„ä¸ºç±»çº§åˆ«çš„é”</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> singleton;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒé‡æ£€æŸ¥æ•°ç›¸å½“äºæ˜¯æ”¹è¿›äº†çš„çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼ã€‚çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼çš„ç¼ºç‚¹æ˜¯æ€§èƒ½é™ä½äº†ï¼Œé€ æˆçš„åŸå› æ˜¯å› ä¸ºå³ä½¿å®ä¾‹å·²ç»å®ä¾‹åŒ–ï¼Œä¾ç„¶æ¯æ¬¡éƒ½ä¼šæœ‰é”ã€‚</p><p>è€Œç°åœ¨ï¼Œæˆ‘ä»¬å°†é”çš„ä½ç½®å˜äº†ï¼Œå¹¶ä¸”å¤šåŠ äº†ä¸€ä¸ªæ£€æŸ¥ã€‚ ä¹Ÿå°±æ˜¯å…ˆåˆ¤æ–­å®ä¾‹æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œè‹¥å·²ç»å­˜åœ¨äº†ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œåˆ¤æ–­æ–¹æ³•å†…çš„æœ‰é”æ–¹æ³•äº†ã€‚ å¦‚æœè¿˜æ²¡æœ‰å®ä¾‹åŒ–ï¼Œå¤šä¸ªçº¿ç¨‹è¿›å»äº†ï¼Œä¹Ÿæ²¡æœ‰äº‹ï¼Œå› ä¸ºé‡Œé¢çš„æ–¹æ³•æœ‰é”ï¼Œåªä¼šè®©ä¸€ä¸ªçº¿ç¨‹è¿›å…¥æœ€å†…å±‚æ–¹æ³•å¹¶å®ä¾‹åŒ–å®ä¾‹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæœ€å¤šæœ€å¤šï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šæœ‰çº¿ç¨‹é˜»å¡çš„æƒ…å†µï¼Œåç»­ä¾¿ä¸ä¼šå†æœ‰çº¿ç¨‹é˜»å¡çš„é—®é¢˜ã€‚</p><p>åŠ ä¸€ä¸ª volatile å…³é”®å­—ä¿®é¥° uniqueInstance ï¼Œvolatile ä¼šç¦æ­¢ JVM çš„æŒ‡ä»¤é‡æ’ï¼Œå°±å¯ä»¥ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®‰å…¨è¿è¡Œã€‚å› ä¸ºæŒ‡ä»¤é‡æ’åºï¼Œå¯èƒ½ä¼šå¯¼è‡´ IdGenerator å¯¹è±¡è¢« new å‡ºæ¥ï¼Œå¹¶ä¸”èµ‹å€¼ç»™ instance ä¹‹åï¼Œè¿˜æ²¡æ¥å¾—åŠåˆå§‹åŒ–ï¼ˆæ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç é€»è¾‘ï¼‰ï¼Œå°±è¢«å¦ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨äº†ã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç»™ instance æˆå‘˜å˜é‡åŠ ä¸Š volatile å…³é”®å­—ï¼Œç¦æ­¢æŒ‡ä»¤é‡æ’åºæ‰è¡Œã€‚å®é™…ä¸Šï¼Œåªæœ‰å¾ˆä½ç‰ˆæœ¬çš„ Java æ‰ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ç°åœ¨ç”¨çš„é«˜ç‰ˆæœ¬çš„ Java å·²ç»åœ¨ JDK å†…éƒ¨å®ç°ä¸­è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ˆè§£å†³çš„æ–¹æ³•å¾ˆç®€å•ï¼Œåªè¦æŠŠå¯¹è±¡ new æ“ä½œå’Œåˆå§‹åŒ–æ“ä½œè®¾è®¡ä¸ºåŸå­æ“ä½œï¼Œå°±è‡ªç„¶èƒ½ç¦æ­¢é‡æ’åºï¼‰ã€‚å…³äºè¿™ç‚¹çš„è¯¦ç»†è§£é‡Šï¼Œè·Ÿç‰¹å®šè¯­è¨€æœ‰å…³ã€‚</p><h3 id="é™æ€å†…éƒ¨ç±»" tabindex="-1"><a class="header-anchor" href="#é™æ€å†…éƒ¨ç±»"><span><strong>é™æ€å†…éƒ¨ç±»</strong></span></a></h3><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ç§æ¯”åŒé‡æ£€æµ‹æ›´åŠ ç®€å•çš„å®ç°æ–¹æ³•ï¼Œé‚£å°±æ˜¯åˆ©ç”¨ Java çš„é™æ€å†…éƒ¨ç±»ã€‚å®ƒæœ‰ç‚¹ç±»ä¼¼é¥¿æ±‰å¼ï¼Œä½†åˆèƒ½åšåˆ°äº†å»¶è¿ŸåŠ è½½ã€‚å…·ä½“æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹å®ƒçš„ä»£ç å®ç°ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AtomicLong</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SingletonHolder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> SingletonHolder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrementAndGet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SingletonHolder æ˜¯ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå½“å¤–éƒ¨ç±» IdGenerator è¢«åŠ è½½çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šåˆ›å»º SingletonHolder å®ä¾‹å¯¹è±¡ã€‚åªæœ‰å½“è°ƒç”¨ getInstance() æ–¹æ³•æ—¶ï¼ŒSingletonHolder æ‰ä¼šè¢«åŠ è½½ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šåˆ›å»º instanceã€‚insance çš„å”¯ä¸€æ€§ã€åˆ›å»ºè¿‡ç¨‹çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œéƒ½ç”± JVM æ¥ä¿è¯ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹æ³•æ—¢ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆèƒ½åšåˆ°å»¶è¿ŸåŠ è½½ã€‚</p><h3 id="æšä¸¾" tabindex="-1"><a class="header-anchor" href="#æšä¸¾"><span><strong>æšä¸¾</strong></span></a></h3><p>æœ€åï¼Œæˆ‘ä»¬ä»‹ç»ä¸€ç§æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼ŒåŸºäºæšä¸¾ç±»å‹çš„å•ä¾‹å®ç°ã€‚è¿™ç§å®ç°æ–¹å¼é€šè¿‡ Java æšä¸¾ç±»å‹æœ¬èº«çš„ç‰¹æ€§ï¼Œä¿è¯äº†å®ä¾‹åˆ›å»ºçš„çº¿ç¨‹å®‰å…¨æ€§å’Œå®ä¾‹çš„å”¯ä¸€æ€§ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> enum</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  INSTANCE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AtomicLong</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrementAndGet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre></div><h2 id="å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜"><span><strong>å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜?</strong></span></a></h2><blockquote><p>å°½ç®¡å•ä¾‹æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œåœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç¡®å®ç»å¸¸ç”¨åˆ°å®ƒï¼Œä½†æ˜¯ï¼Œæœ‰äº›äººè®¤ä¸ºå•ä¾‹æ˜¯ä¸€ç§åæ¨¡å¼ï¼ˆanti-patternï¼‰ï¼Œå¹¶ä¸æ¨èä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œä»Šå¤©ï¼Œæˆ‘å°±é’ˆå¯¹è¿™ä¸ªè¯´æ³•è¯¦ç»†åœ°è®²è®²è¿™å‡ ä¸ªé—®é¢˜ï¼šå•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šè¢«ç§°ä¸ºåæ¨¡å¼ï¼Ÿå¦‚æœä¸ç”¨å•ä¾‹ï¼Œè¯¥å¦‚ä½•è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»ï¼Ÿæœ‰ä½•æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Ÿ</p></blockquote><p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å•ä¾‹ï¼Œéƒ½æ˜¯ç”¨å®ƒæ¥è¡¨ç¤ºä¸€äº›å…¨å±€å”¯ä¸€ç±»ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯ç±»ã€è¿æ¥æ± ç±»ã€ID ç”Ÿæˆå™¨ç±»ã€‚å•ä¾‹æ¨¡å¼ä¹¦å†™ç®€æ´ã€ä½¿ç”¨æ–¹ä¾¿ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼Œç›´æ¥é€šè¿‡ç±»ä¼¼ IdGenerator.getInstance().getId() è¿™æ ·çš„æ–¹æ³•æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œè¿™ç§ä½¿ç”¨æ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ç¡¬ç¼–ç ï¼ˆhard codeï¼‰ï¼Œä¼šå¸¦æ¥è¯¸å¤šé—®é¢˜ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å…·ä½“çœ‹çœ‹åˆ°åº•æœ‰å“ªäº›é—®é¢˜ã€‚</p><h3 id="_1-å•ä¾‹å¯¹-oop-ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½" tabindex="-1"><a class="header-anchor" href="#_1-å•ä¾‹å¯¹-oop-ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½"><span><strong>1. å•ä¾‹å¯¹ OOP ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½</strong></span></a></h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒOOP çš„å››å¤§ç‰¹æ€§æ˜¯å°è£…ã€æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€ã€‚å•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å¯¹äºå…¶ä¸­çš„æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€éƒ½æ”¯æŒå¾—ä¸å¥½ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ IdGenerator è¿™ä¸ªä¾‹å­æ¥è®²è§£ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(...)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> User</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(...)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>IdGenerator çš„ä½¿ç”¨æ–¹å¼è¿èƒŒäº†åŸºäºæ¥å£è€Œéå®ç°çš„è®¾è®¡åŸåˆ™ï¼Œä¹Ÿå°±è¿èƒŒäº†å¹¿ä¹‰ä¸Šç†è§£çš„ OOP çš„æŠ½è±¡ç‰¹æ€§ã€‚å¦‚æœæœªæ¥æŸä¸€å¤©ï¼Œæˆ‘ä»¬å¸Œæœ›é’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡é‡‡ç”¨ä¸åŒçš„ ID ç”Ÿæˆç®—æ³•ã€‚æ¯”å¦‚ï¼Œè®¢å• ID å’Œç”¨æˆ· ID é‡‡ç”¨ä¸åŒçš„ ID ç”Ÿæˆå™¨æ¥ç”Ÿæˆã€‚ä¸ºäº†åº”å¯¹è¿™ä¸ªéœ€æ±‚å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ‰€æœ‰ç”¨åˆ° IdGenerator ç±»çš„åœ°æ–¹ï¼Œè¿™æ ·ä»£ç çš„æ”¹åŠ¨å°±ä¼šæ¯”è¾ƒå¤§ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(...)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // éœ€è¦å°†ä¸Šé¢ä¸€è¡Œä»£ç ï¼Œæ›¿æ¢ä¸ºä¸‹é¢ä¸€è¡Œä»£ç </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> OrderIdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getIntance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> User</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(...)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // éœ€è¦å°†ä¸Šé¢ä¸€è¡Œä»£ç ï¼Œæ›¿æ¢ä¸ºä¸‹é¢ä¸€è¡Œä»£ç </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> UserIdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getIntance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é™¤æ­¤ä¹‹å¤–ï¼Œå•ä¾‹å¯¹ç»§æ‰¿ã€å¤šæ€ç‰¹æ€§çš„æ”¯æŒä¹Ÿä¸å‹å¥½ã€‚è¿™é‡Œæˆ‘ä¹‹æ‰€ä»¥ä¼šç”¨â€œä¸å‹å¥½â€è¿™ä¸ªè¯ï¼Œè€Œéâ€œå®Œå…¨ä¸æ”¯æŒâ€ï¼Œæ˜¯å› ä¸ºä»ç†è®ºä¸Šæ¥è®²ï¼Œå•ä¾‹ç±»ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿ã€ä¹Ÿå¯ä»¥å®ç°å¤šæ€ï¼Œåªæ˜¯å®ç°èµ·æ¥ä¼šéå¸¸å¥‡æ€ªï¼Œä¼šå¯¼è‡´ä»£ç çš„å¯è¯»æ€§å˜å·®ã€‚ä¸æ˜ç™½è®¾è®¡æ„å›¾çš„äººï¼Œçœ‹åˆ°è¿™æ ·çš„è®¾è®¡ï¼Œä¼šè§‰å¾—è«åå…¶å¦™ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦ä½ é€‰æ‹©å°†æŸä¸ªç±»è®¾è®¡æˆåˆ°å•ä¾‹ç±»ï¼Œä¹Ÿå°±æ„å‘³ç€æ”¾å¼ƒäº†ç»§æ‰¿å’Œå¤šæ€è¿™ä¸¤ä¸ªå¼ºæœ‰åŠ›çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œä¹Ÿå°±ç›¸å½“äºæŸå¤±äº†å¯ä»¥åº”å¯¹æœªæ¥éœ€æ±‚å˜åŒ–çš„æ‰©å±•æ€§ã€‚</p><h3 id="_2-å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_2-å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»"><span><strong>2. å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»</strong></span></a></h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œä»£ç çš„å¯è¯»æ€§éå¸¸é‡è¦ã€‚åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€çœ¼å°±èƒ½çœ‹å‡ºç±»ä¸ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œææ¸…æ¥šè¿™ä¸ªç±»ä¾èµ–äº†å“ªäº›å¤–éƒ¨ç±»ã€‚</p><p>é€šè¿‡æ„é€ å‡½æ•°ã€å‚æ•°ä¼ é€’ç­‰æ–¹å¼å£°æ˜çš„ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹å‡½æ•°çš„å®šä¹‰ï¼Œå°±èƒ½å¾ˆå®¹æ˜“è¯†åˆ«å‡ºæ¥ã€‚ä½†æ˜¯ï¼Œå•ä¾‹ç±»ä¸éœ€è¦æ˜¾ç¤ºåˆ›å»ºã€ä¸éœ€è¦ä¾èµ–å‚æ•°ä¼ é€’ï¼Œåœ¨å‡½æ•°ä¸­ç›´æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚å¦‚æœä»£ç æ¯”è¾ƒå¤æ‚ï¼Œè¿™ç§è°ƒç”¨å…³ç³»å°±ä¼šéå¸¸éšè”½ã€‚åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»”ç»†æŸ¥çœ‹æ¯ä¸ªå‡½æ•°çš„ä»£ç å®ç°ï¼Œæ‰èƒ½çŸ¥é“è¿™ä¸ªç±»åˆ°åº•ä¾èµ–äº†å“ªäº›å•ä¾‹ç±»ã€‚</p><h3 id="_3-å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½" tabindex="-1"><a class="header-anchor" href="#_3-å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½"><span><strong>3. å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½</strong></span></a></h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œå•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚å¦‚æœæœªæ¥æŸä¸€å¤©ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­åˆ›å»ºä¸¤ä¸ªå®ä¾‹æˆ–å¤šä¸ªå®ä¾‹ï¼Œé‚£å°±è¦å¯¹ä»£ç æœ‰æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚ä½ å¯èƒ½ä¼šè¯´ï¼Œä¼šæœ‰è¿™æ ·çš„éœ€æ±‚å—ï¼Ÿæ—¢ç„¶å•ä¾‹ç±»å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½ç”¨æ¥è¡¨ç¤ºå…¨å±€ç±»ï¼Œæ€ä¹ˆä¼šéœ€è¦ä¸¤ä¸ªæˆ–è€…å¤šä¸ªå®ä¾‹å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œè¿™æ ·çš„éœ€æ±‚å¹¶ä¸å°‘è§ã€‚æˆ‘ä»¬æ‹¿æ•°æ®åº“è¿æ¥æ± æ¥ä¸¾ä¾‹è§£é‡Šä¸€ä¸‹ã€‚</p><p>åœ¨ç³»ç»Ÿè®¾è®¡åˆæœŸï¼Œæˆ‘ä»¬è§‰å¾—ç³»ç»Ÿä¸­åªåº”è¯¥æœ‰ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œè¿™æ ·èƒ½æ–¹ä¾¿æˆ‘ä»¬æ§åˆ¶å¯¹æ•°æ®åº“è¿æ¥èµ„æºçš„æ¶ˆè€—ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠæ•°æ®åº“è¿æ¥æ± ç±»è®¾è®¡æˆäº†å•ä¾‹ç±»ã€‚ä½†ä¹‹åæˆ‘ä»¬å‘ç°ï¼Œç³»ç»Ÿä¸­æœ‰äº› SQL è¯­å¥è¿è¡Œå¾—éå¸¸æ…¢ã€‚è¿™äº› SQL è¯­å¥åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œé•¿æ—¶é—´å ç”¨æ•°æ®åº“è¿æ¥èµ„æºï¼Œå¯¼è‡´å…¶ä»– SQL è¯·æ±‚æ— æ³•å“åº”ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ…¢ SQL ä¸å…¶ä»– SQL éš”ç¦»å¼€æ¥æ‰§è¡Œã€‚ä¸ºäº†å®ç°è¿™æ ·çš„ç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸¤ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œæ…¢ SQL ç‹¬äº«ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œå…¶ä»– SQL ç‹¬äº«å¦å¤–ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œè¿™æ ·å°±èƒ½é¿å…æ…¢ SQL å½±å“åˆ°å…¶ä»– SQL çš„æ‰§è¡Œã€‚</p><p>å¦‚æœæˆ‘ä»¬å°†æ•°æ®åº“è¿æ¥æ± è®¾è®¡æˆå•ä¾‹ç±»ï¼Œæ˜¾ç„¶å°±æ— æ³•é€‚åº”è¿™æ ·çš„éœ€æ±‚å˜æ›´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå•ä¾‹ç±»åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå½±å“ä»£ç çš„æ‰©å±•æ€§ã€çµæ´»æ€§ã€‚æ‰€ä»¥ï¼Œæ•°æ®åº“è¿æ¥æ± ã€çº¿ç¨‹æ± è¿™ç±»çš„èµ„æºæ± ï¼Œæœ€å¥½è¿˜æ˜¯ä¸è¦è®¾è®¡æˆå•ä¾‹ç±»ã€‚å®é™…ä¸Šï¼Œä¸€äº›å¼€æºçš„æ•°æ®åº“è¿æ¥æ± ã€çº¿ç¨‹æ± ä¹Ÿç¡®å®æ²¡æœ‰è®¾è®¡æˆå•ä¾‹ç±»ã€‚</p><h3 id="_4-å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½" tabindex="-1"><a class="header-anchor" href="#_4-å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½"><span><strong>4. å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½</strong></span></a></h3><p>å•ä¾‹æ¨¡å¼çš„ä½¿ç”¨ä¼šå½±å“åˆ°ä»£ç çš„å¯æµ‹è¯•æ€§ã€‚å¦‚æœå•ä¾‹ç±»ä¾èµ–æ¯”è¾ƒé‡çš„å¤–éƒ¨èµ„æºï¼Œæ¯”å¦‚ DBï¼Œæˆ‘ä»¬åœ¨å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œå¸Œæœ›èƒ½é€šè¿‡ mock çš„æ–¹å¼å°†å®ƒæ›¿æ¢æ‰ã€‚è€Œå•ä¾‹ç±»è¿™ç§ç¡¬ç¼–ç å¼çš„ä½¿ç”¨æ–¹å¼ï¼Œå¯¼è‡´æ— æ³•å®ç° mock æ›¿æ¢ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœå•ä¾‹ç±»æŒæœ‰æˆå‘˜å˜é‡ï¼ˆæ¯”å¦‚ IdGenerator ä¸­çš„ id æˆå‘˜å˜é‡ï¼‰ï¼Œé‚£å®ƒå®é™…ä¸Šç›¸å½“äºä¸€ç§å…¨å±€å˜é‡ï¼Œè¢«æ‰€æœ‰çš„ä»£ç å…±äº«ã€‚å¦‚æœè¿™ä¸ªå…¨å±€å˜é‡æ˜¯ä¸€ä¸ªå¯å˜å…¨å±€å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„æˆå‘˜å˜é‡æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼Œé‚£æˆ‘ä»¬åœ¨ç¼–å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ³¨æ„ä¸åŒæµ‹è¯•ç”¨ä¾‹ä¹‹é—´ï¼Œä¿®æ”¹äº†å•ä¾‹ç±»ä¸­çš„åŒä¸€ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œä»è€Œå¯¼è‡´æµ‹è¯•ç»“æœäº’ç›¸å½±å“çš„é—®é¢˜ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥å›è¿‡å¤´å»çœ‹ä¸‹ç¬¬ 29 è®²ä¸­çš„â€œå…¶ä»–å¸¸è§çš„ Anti-Patternsï¼šå…¨å±€å˜é‡â€é‚£éƒ¨åˆ†çš„ä»£ç ç¤ºä¾‹å’Œè®²è§£ã€‚</p><h3 id="_5-å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_5-å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°"><span><strong>5. å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°</strong></span></a></h3><p>å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿æ¥æ± çš„å•ä¾‹å¯¹è±¡ï¼Œæˆ‘ä»¬æ²¡æ³•é€šè¿‡å‚æ•°æ¥æŒ‡å®šè¿æ¥æ± çš„å¤§å°ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹éƒ½æœ‰å“ªäº›è§£å†³æ–¹æ¡ˆã€‚</p><p>ç¬¬ä¸€ç§è§£å†³æ€è·¯æ˜¯ï¼šåˆ›å»ºå®Œå®ä¾‹ä¹‹åï¼Œå†è°ƒç”¨ init() å‡½æ•°ä¼ é€’å‚æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è¿™ä¸ªå•ä¾‹ç±»çš„æ—¶å€™ï¼Œè¦å…ˆè°ƒç”¨ init() æ–¹æ³•ï¼Œç„¶åæ‰èƒ½è°ƒç”¨ getInstance() æ–¹æ³•ï¼Œå¦åˆ™ä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> paramA;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> paramB;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Run init() first.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> init</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Singleton has been created!&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(paramA, paramB);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">init</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å…ˆinitï¼Œå†ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>ç¬¬äºŒç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ° getIntance() æ–¹æ³•ä¸­ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> paramA;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> paramB;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(paramA, paramB);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œä¸Šé¢çš„ä»£ç å®ç°ç¨å¾®æœ‰ç‚¹é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬å¦‚ä¸‹ä¸¤æ¬¡æ‰§è¡Œ getInstance() æ–¹æ³•ï¼Œé‚£è·å–åˆ°çš„ singleton1 å’Œ signleton2 çš„ paramA å’Œ paramB éƒ½æ˜¯ 10 å’Œ 50ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒæ¬¡çš„å‚æ•°ï¼ˆ20ï¼Œ30ï¼‰æ²¡æœ‰èµ·ä½œç”¨ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿç•™ç»™ä½ è‡ªå·±æ€è€ƒï¼Œä½ å¯ä»¥åœ¨ç•™è¨€åŒºè¯´è¯´ä½ çš„è§£å†³æ€è·¯ã€‚</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre></div><p>ç¬¬ä¸‰ç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ°å¦å¤–ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹ã€‚Config æ˜¯ä¸€ä¸ªå­˜å‚¨äº† paramA å’Œ paramB å€¼çš„å…¨å±€å˜é‡ã€‚é‡Œé¢çš„å€¼æ—¢å¯ä»¥åƒä¸‹é¢çš„ä»£ç é‚£æ ·é€šè¿‡é™æ€å¸¸é‡æ¥å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½å¾—åˆ°ã€‚å®é™…ä¸Šï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€å€¼å¾—æ¨èçš„ã€‚</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PARAM_A </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 123</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> fianl </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PARAM_B </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 245</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">PARAM_A</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">PARAM_B</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> instance;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><h2 id="æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆ"><span><strong>æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ</strong></span></a></h2><p>åˆšåˆšæˆ‘ä»¬æåˆ°äº†å•ä¾‹çš„å¾ˆå¤šé—®é¢˜ï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œå³ä¾¿å•ä¾‹æœ‰è¿™ä¹ˆå¤šé—®é¢˜ï¼Œä½†æˆ‘ä¸ç”¨ä¸è¡Œå•Šã€‚æˆ‘ä¸šåŠ¡ä¸Šæœ‰è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»çš„éœ€æ±‚ï¼Œå¦‚æœä¸ç”¨å•ä¾‹ï¼Œæˆ‘æ€ä¹ˆæ‰èƒ½ä¿è¯è¿™ä¸ªç±»çš„å¯¹è±¡å…¨å±€å”¯ä¸€å‘¢ï¼Ÿ</p><p>ä¸ºäº†ä¿è¯å…¨å±€å”¯ä¸€ï¼Œé™¤äº†ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨é™æ€æ–¹æ³•æ¥å®ç°ã€‚è¿™ä¹Ÿæ˜¯é¡¹ç›®å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„ä¸€ç§å®ç°æ€è·¯ã€‚æ¯”å¦‚ï¼Œä¸Šä¸€èŠ‚è¯¾ä¸­è®²çš„ ID å”¯ä¸€é€’å¢ç”Ÿæˆå™¨çš„ä¾‹å­ï¼Œç”¨é™æ€æ–¹æ³•å®ç°ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// é™æ€æ–¹æ³•å®ç°æ–¹å¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AtomicLong</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrementAndGet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ä½¿ç”¨ä¸¾ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre></div><p>ä¸è¿‡ï¼Œé™æ€æ–¹æ³•è¿™ç§å®ç°æ€è·¯ï¼Œå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é—®é¢˜ã€‚å®é™…ä¸Šï¼Œå®ƒæ¯”å•ä¾‹æ›´åŠ ä¸çµæ´»ï¼Œæ¯”å¦‚ï¼Œå®ƒæ— æ³•æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–åŠæ³•ã€‚å®é™…ä¸Šï¼Œå•ä¾‹é™¤äº†æˆ‘ä»¬ä¹‹å‰è®²åˆ°çš„ä½¿ç”¨æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªç§ä½¿ç”¨æ–¹æ³•ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 1. è€çš„ä½¿ç”¨æ–¹å¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> demofunction</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  //...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 2. æ–°çš„ä½¿ç”¨æ–¹å¼ï¼šä¾èµ–æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> demofunction</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> idGenerator) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> idGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// å¤–éƒ¨è°ƒç”¨demofunction()çš„æ—¶å€™ï¼Œä¼ å…¥idGenerator</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IdGenerator</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> idGenerator </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInsance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">demofunction</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(idGenerator)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><p>åŸºäºæ–°çš„ä½¿ç”¨æ–¹å¼ï¼Œæˆ‘ä»¬å°†å•ä¾‹ç”Ÿæˆçš„å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’ç»™ç±»çš„æˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥è§£å†³å•ä¾‹éšè—ç±»ä¹‹é—´ä¾èµ–å…³ç³»çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œå¯¹äºå•ä¾‹å­˜åœ¨çš„å…¶ä»–é—®é¢˜ï¼Œæ¯”å¦‚å¯¹ OOP ç‰¹æ€§ã€æ‰©å±•æ€§ã€å¯æµ‹æ€§ä¸å‹å¥½ç­‰é—®é¢˜ï¼Œè¿˜æ˜¯æ— æ³•è§£å†³ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœè¦å®Œå…¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä»æ ¹ä¸Šï¼Œå¯»æ‰¾å…¶ä»–æ–¹å¼æ¥å®ç°å…¨å±€å”¯ä¸€ç±»ã€‚å®é™…ä¸Šï¼Œç±»å¯¹è±¡çš„å…¨å±€å”¯ä¸€æ€§å¯ä»¥é€šè¿‡å¤šç§ä¸åŒçš„æ–¹å¼æ¥ä¿è¯ã€‚æˆ‘ä»¬æ—¢å¯ä»¥é€šè¿‡å•ä¾‹æ¨¡å¼æ¥å¼ºåˆ¶ä¿è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å·¥å‚æ¨¡å¼ã€IOC å®¹å™¨ï¼ˆæ¯”å¦‚ Spring IOC å®¹å™¨ï¼‰æ¥ä¿è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡ç¨‹åºå‘˜è‡ªå·±æ¥ä¿è¯ï¼ˆè‡ªå·±åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™è‡ªå·±ä¿è¯ä¸è¦åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡ï¼‰ã€‚è¿™å°±ç±»ä¼¼ Java ä¸­å†…å­˜å¯¹è±¡çš„é‡Šæ”¾ç”± JVM æ¥è´Ÿè´£ï¼Œè€Œ C++ ä¸­ç”±ç¨‹åºå‘˜è‡ªå·±è´Ÿè´£ï¼Œé“ç†æ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="å¦‚ä½•ç†è§£å•ä¾‹æ¨¡å¼ä¸­çš„å”¯ä¸€æ€§" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ç†è§£å•ä¾‹æ¨¡å¼ä¸­çš„å”¯ä¸€æ€§"><span><strong>å¦‚ä½•ç†è§£å•ä¾‹æ¨¡å¼ä¸­çš„å”¯ä¸€æ€§ï¼Ÿ</strong></span></a></h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬é‡æ–°çœ‹ä¸€ä¸‹å•ä¾‹çš„å®šä¹‰ï¼šâ€œä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºå”¯ä¸€ä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–è€…å®ä¾‹ï¼‰ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«ä½œå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°å•ä¾‹æ¨¡å¼ã€‚â€</p><p>å®šä¹‰ä¸­æåˆ°ï¼Œâ€œä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºå”¯ä¸€ä¸€ä¸ªå¯¹è±¡â€ã€‚é‚£å¯¹è±¡çš„å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯æŒ‡çº¿ç¨‹å†…åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜æ˜¯æŒ‡è¿›ç¨‹å†…åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Ÿç­”æ¡ˆæ˜¯åè€…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå•ä¾‹æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡æ˜¯è¿›ç¨‹å”¯ä¸€çš„ã€‚è¿™é‡Œæœ‰ç‚¹ä¸å¥½ç†è§£ï¼Œæˆ‘æ¥è¯¦ç»†åœ°è§£é‡Šä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬ç¼–å†™çš„ä»£ç ï¼Œé€šè¿‡ç¼–è¯‘ã€é“¾æ¥ï¼Œç»„ç»‡åœ¨ä¸€èµ·ï¼Œå°±æ„æˆäº†ä¸€ä¸ªæ“ä½œç³»ç»Ÿå¯ä»¥æ‰§è¡Œçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„â€œå¯æ‰§è¡Œæ–‡ä»¶â€ï¼ˆæ¯”å¦‚ Windows ä¸‹çš„ exe æ–‡ä»¶ï¼‰ã€‚å¯æ‰§è¡Œæ–‡ä»¶å®é™…ä¸Šå°±æ˜¯ä»£ç è¢«ç¿»è¯‘æˆæ“ä½œç³»ç»Ÿå¯ç†è§£çš„ä¸€ç»„æŒ‡ä»¤ï¼Œä½ å®Œå…¨å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºå°±æ˜¯ä»£ç æœ¬èº«ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨å‘½ä»¤è¡Œæˆ–è€…åŒå‡»è¿è¡Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿä¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œå°†è¿™ä¸ªæ‰§è¡Œæ–‡ä»¶ä»ç£ç›˜åŠ è½½åˆ°è‡ªå·±çš„è¿›ç¨‹åœ°å€ç©ºé—´ï¼ˆå¯ä»¥ç†è§£æ“ä½œç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…çš„å†…å­˜å­˜å‚¨åŒºï¼Œç”¨æ¥å­˜å‚¨ä»£ç å’Œæ•°æ®ï¼‰ã€‚æ¥ç€ï¼Œè¿›ç¨‹å°±ä¸€æ¡ä¸€æ¡åœ°æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«çš„ä»£ç ã€‚æ¯”å¦‚ï¼Œå½“è¿›ç¨‹è¯»åˆ°ä»£ç ä¸­çš„ User user = new User(); è¿™æ¡è¯­å¥çš„æ—¶å€™ï¼Œå®ƒå°±åœ¨è‡ªå·±çš„åœ°å€ç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ª user ä¸´æ—¶å˜é‡å’Œä¸€ä¸ª User å¯¹è±¡ã€‚</p><p>è¿›ç¨‹ä¹‹é—´æ˜¯ä¸å…±äº«åœ°å€ç©ºé—´çš„ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­åˆ›å»ºå¦å¤–ä¸€ä¸ªè¿›ç¨‹ï¼ˆæ¯”å¦‚ï¼Œä»£ç ä¸­æœ‰ä¸€ä¸ª fork() è¯­å¥ï¼Œè¿›ç¨‹æ‰§è¡Œåˆ°è¿™æ¡è¯­å¥çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼šç»™æ–°è¿›ç¨‹åˆ†é…æ–°çš„åœ°å€ç©ºé—´ï¼Œå¹¶ä¸”å°†è€è¿›ç¨‹åœ°å€ç©ºé—´çš„æ‰€æœ‰å†…å®¹ï¼Œé‡æ–°æ‹·è´ä¸€ä»½åˆ°æ–°è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ï¼Œè¿™äº›å†…å®¹åŒ…æ‹¬ä»£ç ã€æ•°æ®ï¼ˆæ¯”å¦‚ user ä¸´æ—¶å˜é‡ã€User å¯¹è±¡ï¼‰ã€‚</p><p>æ‰€ä»¥ï¼Œå•ä¾‹ç±»åœ¨è€è¿›ç¨‹ä¸­å­˜åœ¨ä¸”åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æ–°è¿›ç¨‹ä¸­ä¹Ÿä¼šå­˜åœ¨ä¸”åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ã€‚è€Œä¸”ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å¹¶ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¹Ÿå°±è¯´ï¼Œå•ä¾‹ç±»ä¸­å¯¹è±¡çš„å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´æ˜¯è¿›ç¨‹å†…çš„ï¼Œåœ¨è¿›ç¨‹é—´æ˜¯ä¸å”¯ä¸€çš„ã€‚</p><h2 id="å¦‚ä½•å®ç°çº¿ç¨‹å”¯ä¸€çš„å•ä¾‹" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å®ç°çº¿ç¨‹å”¯ä¸€çš„å•ä¾‹"><span><strong>å¦‚ä½•å®ç°çº¿ç¨‹å”¯ä¸€çš„å•ä¾‹ï¼Ÿ</strong></span></a></h2><p>åˆšåˆšæˆ‘ä»¬è®²äº†å•ä¾‹ç±»å¯¹è±¡æ˜¯è¿›ç¨‹å”¯ä¸€çš„ï¼Œä¸€ä¸ªè¿›ç¨‹åªèƒ½æœ‰ä¸€ä¸ªå•ä¾‹å¯¹è±¡ã€‚é‚£å¦‚ä½•å®ç°ä¸€ä¸ªçº¿ç¨‹å”¯ä¸€çš„å•ä¾‹å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œä»€ä¹ˆæ˜¯çº¿ç¨‹å”¯ä¸€çš„å•ä¾‹ï¼Œä»¥åŠâ€œçº¿ç¨‹å”¯ä¸€â€å’Œâ€œè¿›ç¨‹å”¯ä¸€â€çš„åŒºåˆ«ã€‚</p><p>â€œè¿›ç¨‹å”¯ä¸€â€æŒ‡çš„æ˜¯è¿›ç¨‹å†…å”¯ä¸€ï¼Œè¿›ç¨‹é—´ä¸å”¯ä¸€ã€‚ç±»æ¯”ä¸€ä¸‹ï¼Œâ€œçº¿ç¨‹å”¯ä¸€â€æŒ‡çš„æ˜¯çº¿ç¨‹å†…å”¯ä¸€ï¼Œçº¿ç¨‹é—´å¯ä»¥ä¸å”¯ä¸€ã€‚å®é™…ä¸Šï¼Œâ€œè¿›ç¨‹å”¯ä¸€â€è¿˜ä»£è¡¨äº†çº¿ç¨‹å†…ã€çº¿ç¨‹é—´éƒ½å”¯ä¸€ï¼Œè¿™ä¹Ÿæ˜¯â€œè¿›ç¨‹å”¯ä¸€â€å’Œâ€œçº¿ç¨‹å”¯ä¸€â€çš„åŒºåˆ«ä¹‹å¤„ã€‚è¿™æ®µè¯å¬èµ·æ¥æœ‰ç‚¹åƒç»•å£ä»¤ï¼Œæˆ‘ä¸¾ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚</p><p>å‡è®¾ IdGenerator æ˜¯ä¸€ä¸ªçº¿ç¨‹å”¯ä¸€çš„å•ä¾‹ç±»ã€‚åœ¨çº¿ç¨‹ A å†…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå•ä¾‹å¯¹è±¡ aã€‚å› ä¸ºçº¿ç¨‹å†…å”¯ä¸€ï¼Œåœ¨çº¿ç¨‹ A å†…å°±ä¸èƒ½å†åˆ›å»ºæ–°çš„ IdGenerator å¯¹è±¡äº†ï¼Œè€Œçº¿ç¨‹é—´å¯ä»¥ä¸å”¯ä¸€ï¼Œæ‰€ä»¥ï¼Œåœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ B å†…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„å•ä¾‹å¯¹è±¡ bã€‚</p><p>å°½ç®¡æ¦‚å¿µç†è§£èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œä½†çº¿ç¨‹å”¯ä¸€å•ä¾‹çš„ä»£ç å®ç°å¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ª HashMap æ¥å­˜å‚¨å¯¹è±¡ï¼Œå…¶ä¸­ key æ˜¯çº¿ç¨‹ IDï¼Œvalue æ˜¯å¯¹è±¡ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åšåˆ°ï¼Œä¸åŒçš„çº¿ç¨‹å¯¹åº”ä¸åŒçš„å¯¹è±¡ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹åªèƒ½å¯¹åº”ä¸€ä¸ªå¯¹è±¡ã€‚å®é™…ä¸Šï¼ŒJava è¯­è¨€æœ¬èº«æä¾›äº† ThreadLocal å·¥å…·ç±»ï¼Œå¯ä»¥æ›´åŠ è½»æ¾åœ°å®ç°çº¿ç¨‹å”¯ä¸€å•ä¾‹ã€‚ä¸è¿‡ï¼ŒThreadLocal åº•å±‚å®ç°åŸç†ä¹Ÿæ˜¯åŸºäºä¸‹é¢ä»£ç ä¸­æ‰€ç¤ºçš„ HashMapã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AtomicLong</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ConcurrentHashMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> instances</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">          =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ConcurrentHashMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    Long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> currentThreadId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Thread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">currentThread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    instances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">putIfAbsent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(currentThreadId, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> instances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(currentThreadId);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrementAndGet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å¦‚ä½•å®ç°é›†ç¾¤ç¯å¢ƒä¸‹çš„å•ä¾‹" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å®ç°é›†ç¾¤ç¯å¢ƒä¸‹çš„å•ä¾‹"><span><strong>å¦‚ä½•å®ç°é›†ç¾¤ç¯å¢ƒä¸‹çš„å•ä¾‹ï¼Ÿ</strong></span></a></h2><p>åˆšåˆšæˆ‘ä»¬è®²äº†â€œè¿›ç¨‹å”¯ä¸€â€çš„å•ä¾‹å’Œâ€œçº¿ç¨‹å”¯ä¸€â€çš„å•ä¾‹ï¼Œç°åœ¨ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹ï¼Œâ€œé›†ç¾¤å”¯ä¸€â€çš„å•ä¾‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥è§£é‡Šä¸€ä¸‹ï¼Œä»€ä¹ˆæ˜¯â€œé›†ç¾¤å”¯ä¸€â€çš„å•ä¾‹ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯å°†å®ƒè·Ÿâ€œè¿›ç¨‹å”¯ä¸€â€â€œçº¿ç¨‹å”¯ä¸€â€åšä¸ªå¯¹æ¯”ã€‚â€œè¿›ç¨‹å”¯ä¸€â€æŒ‡çš„æ˜¯è¿›ç¨‹å†…å”¯ä¸€ã€è¿›ç¨‹é—´ä¸å”¯ä¸€ã€‚â€œçº¿ç¨‹å”¯ä¸€â€æŒ‡çš„æ˜¯çº¿ç¨‹å†…å”¯ä¸€ã€çº¿ç¨‹é—´ä¸å”¯ä¸€ã€‚é›†ç¾¤ç›¸å½“äºå¤šä¸ªè¿›ç¨‹æ„æˆçš„ä¸€ä¸ªé›†åˆï¼Œâ€œé›†ç¾¤å”¯ä¸€â€å°±ç›¸å½“äºæ˜¯è¿›ç¨‹å†…å”¯ä¸€ã€è¿›ç¨‹é—´ä¹Ÿå”¯ä¸€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„è¿›ç¨‹é—´å…±äº«åŒä¸€ä¸ªå¯¹è±¡ï¼Œä¸èƒ½åˆ›å»ºåŒä¸€ä¸ªç±»çš„å¤šä¸ªå¯¹è±¡ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œç»å…¸çš„å•ä¾‹æ¨¡å¼æ˜¯è¿›ç¨‹å†…å”¯ä¸€çš„ï¼Œé‚£å¦‚ä½•å®ç°ä¸€ä¸ªè¿›ç¨‹é—´ä¹Ÿå”¯ä¸€çš„å•ä¾‹å‘¢ï¼Ÿå¦‚æœä¸¥æ ¼æŒ‰ç…§ä¸åŒçš„è¿›ç¨‹é—´å…±äº«åŒä¸€ä¸ªå¯¹è±¡æ¥å®ç°ï¼Œé‚£é›†ç¾¤å”¯ä¸€çš„å•ä¾‹å®ç°èµ·æ¥å°±æœ‰ç‚¹éš¾åº¦äº†ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡åºåˆ—åŒ–å¹¶å­˜å‚¨åˆ°å¤–éƒ¨å…±äº«å­˜å‚¨åŒºï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰ã€‚è¿›ç¨‹åœ¨ä½¿ç”¨è¿™ä¸ªå•ä¾‹å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦å…ˆä»å¤–éƒ¨å…±äº«å­˜å‚¨åŒºä¸­å°†å®ƒè¯»å–åˆ°å†…å­˜ï¼Œå¹¶ååºåˆ—åŒ–æˆå¯¹è±¡ï¼Œç„¶åå†ä½¿ç”¨ï¼Œä½¿ç”¨å®Œæˆä¹‹åè¿˜éœ€è¦å†å­˜å‚¨å›å¤–éƒ¨å…±äº«å­˜å‚¨åŒºã€‚</p><p>ä¸ºäº†ä¿è¯ä»»ä½•æ—¶åˆ»ï¼Œåœ¨è¿›ç¨‹é—´éƒ½åªæœ‰ä¸€ä»½å¯¹è±¡å­˜åœ¨ï¼Œä¸€ä¸ªè¿›ç¨‹åœ¨è·å–åˆ°å¯¹è±¡ä¹‹åï¼Œéœ€è¦å¯¹å¯¹è±¡åŠ é”ï¼Œé¿å…å…¶ä»–è¿›ç¨‹å†å°†å…¶è·å–ã€‚åœ¨è¿›ç¨‹ä½¿ç”¨å®Œè¿™ä¸ªå¯¹è±¡ä¹‹åï¼Œè¿˜éœ€è¦æ˜¾å¼åœ°å°†å¯¹è±¡ä»å†…å­˜ä¸­åˆ é™¤ï¼Œå¹¶ä¸”é‡Šæ”¾å¯¹å¯¹è±¡çš„åŠ é”ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ç”¨ä¼ªä»£ç å®ç°äº†ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AtomicLong</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> AtomicLong</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SharedObjectStorage</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> storage </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> FileSharedObjectStorage</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/*å…¥å‚çœç•¥ï¼Œæ¯”å¦‚æ–‡ä»¶åœ°å€*/</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DistributedLock</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> lock </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> DistributedLock</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> == </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">      lock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> storage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">load</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> synchroinzed </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> freeInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    storage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">IdGeneator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //é‡Šæ”¾å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    lock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">unlock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getId</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() { </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrementAndGet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// IdGeneratorä½¿ç”¨ä¸¾ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IdGenerator</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> idGeneator </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> idGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">IdGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">freeInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><h2 id="å¦‚ä½•å®ç°ä¸€ä¸ªå¤šä¾‹æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å®ç°ä¸€ä¸ªå¤šä¾‹æ¨¡å¼"><span><strong>å¦‚ä½•å®ç°ä¸€ä¸ªå¤šä¾‹æ¨¡å¼ï¼Ÿ</strong></span></a></h2><p>è·Ÿå•ä¾‹æ¨¡å¼æ¦‚å¿µç›¸å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ªå¤šä¾‹æ¨¡å¼ã€‚é‚£å¦‚ä½•å®ç°ä¸€ä¸ªå¤šä¾‹æ¨¡å¼å‘¢ï¼Ÿ</p><p>â€œå•ä¾‹â€æŒ‡çš„æ˜¯ï¼Œä¸€ä¸ªç±»åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚å¯¹åº”åœ°ï¼Œâ€œå¤šä¾‹â€æŒ‡çš„å°±æ˜¯ï¼Œä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸ªæ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ¯”å¦‚åªèƒ½åˆ›å»º 3 ä¸ªå¯¹è±¡ã€‚å¦‚æœç”¨ä»£ç æ¥ç®€å•ç¤ºä¾‹ä¸€ä¸‹çš„è¯ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BackendServer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> serverNo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> serverAddress</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> SERVER_COUNT </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Map</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Long</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BackendServer</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> serverInstances </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> HashMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  static</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    serverInstances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BackendServer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.134.22.138:8080&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    serverInstances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BackendServer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.134.22.139:8080&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    serverInstances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BackendServer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.134.22.140:8080&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BackendServer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">long</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> serverNo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> serverAddress</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">serverNo</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> serverNo;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">serverAddress</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> serverAddress;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BackendServer</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">long</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> serverNo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> serverInstances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(serverNo);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BackendServer</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getRandomInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    Random</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> r</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Random</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> no</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nextInt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(SERVER_COUNT)</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> serverInstances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(no);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>å®é™…ä¸Šï¼Œå¯¹äºå¤šä¾‹æ¨¡å¼ï¼Œè¿˜æœ‰ä¸€ç§ç†è§£æ–¹å¼ï¼šåŒä¸€ç±»å‹çš„åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸åŒç±»å‹çš„å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ã€‚è¿™é‡Œçš„â€œç±»å‹â€å¦‚ä½•ç†è§£å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚åœ¨ä»£ç ä¸­ï¼Œlogger name å°±æ˜¯åˆšåˆšè¯´çš„â€œç±»å‹â€ï¼ŒåŒä¸€ä¸ª logger name è·å–åˆ°çš„å¯¹è±¡å®ä¾‹æ˜¯ç›¸åŒçš„ï¼Œä¸åŒçš„ logger name è·å–åˆ°çš„å¯¹è±¡å®ä¾‹æ˜¯ä¸åŒçš„ã€‚</p><div class="language-java line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="java" style="--vp-collapsed-lines:20;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ConcurrentHashMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> instances</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">          =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ConcurrentHashMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> loggerName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    instances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">putIfAbsent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(loggerName, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> instances</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(loggerName);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//l1==l2, l1!=l3</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> l1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;User.class&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> l2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;User.class&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> l3 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Logger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Order.class&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>è¿™ç§å¤šä¾‹æ¨¡å¼çš„ç†è§£æ–¹å¼æœ‰ç‚¹ç±»ä¼¼å·¥å‚æ¨¡å¼ã€‚å®ƒè·Ÿå·¥å‚æ¨¡å¼çš„ä¸åŒä¹‹å¤„æ˜¯ï¼Œå¤šä¾‹æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œè€Œå·¥å‚æ¨¡å¼åˆ›å»ºçš„æ˜¯ä¸åŒå­ç±»çš„å¯¹è±¡ï¼Œå…³äºè¿™ä¸€ç‚¹ï¼Œä¸‹ä¸€èŠ‚è¯¾ä¸­å°±ä¼šè®²åˆ°ã€‚å®é™…ä¸Šï¼Œå®ƒè¿˜æœ‰ç‚¹ç±»ä¼¼äº«å…ƒæ¨¡å¼ï¼Œä¸¤è€…çš„åŒºåˆ«ç­‰åˆ°æˆ‘ä»¬è®²åˆ°äº«å…ƒæ¨¡å¼çš„æ—¶å€™å†æ¥åˆ†æã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®é™…ä¸Šï¼Œæšä¸¾ç±»å‹ä¹Ÿç›¸å½“äºå¤šä¾‹æ¨¡å¼ï¼Œä¸€ä¸ªç±»å‹åªèƒ½å¯¹åº”ä¸€ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ã€‚</p><h2 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span><strong>æ€»ç»“</strong></span></a></h2><p><strong>1. å•ä¾‹çš„å®šä¹‰</strong></p><p>å•ä¾‹è®¾è®¡æ¨¡å¼ï¼ˆSingleton Design Patternï¼‰ç†è§£èµ·æ¥éå¸¸ç®€å•ã€‚ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–è€…å«å®ä¾‹ï¼‰ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«ä½œå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°å•ä¾‹æ¨¡å¼ã€‚</p><p><strong>2. å•ä¾‹çš„ç”¨å¤„</strong></p><p>ä»ä¸šåŠ¡æ¦‚å¿µä¸Šï¼Œæœ‰äº›æ•°æ®åœ¨ç³»ç»Ÿä¸­åªåº”è¯¥ä¿å­˜ä¸€ä»½ï¼Œå°±æ¯”è¾ƒé€‚åˆè®¾è®¡ä¸ºå•ä¾‹ç±»ã€‚æ¯”å¦‚ï¼Œç³»ç»Ÿçš„é…ç½®ä¿¡æ¯ç±»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å•ä¾‹è§£å†³èµ„æºè®¿é—®å†²çªçš„é—®é¢˜ã€‚</p><p><strong>3. å•ä¾‹çš„å®ç°</strong></p><p>å•ä¾‹æœ‰ä¸‹é¢å‡ ç§ç»å…¸çš„å®ç°æ–¹å¼ã€‚</p><ul><li><strong>é¥¿æ±‰å¼</strong></li></ul><p>é¥¿æ±‰å¼çš„å®ç°æ–¹å¼ï¼Œåœ¨ç±»åŠ è½½çš„æœŸé—´ï¼Œå°±å·²ç»å°† instance é™æ€å®ä¾‹åˆå§‹åŒ–å¥½äº†ï¼Œæ‰€ä»¥ï¼Œinstance å®ä¾‹çš„åˆ›å»ºæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸è¿‡ï¼Œè¿™æ ·çš„å®ç°æ–¹å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½å®ä¾‹ã€‚</p><ul><li><strong>æ‡’æ±‰å¼</strong></li></ul><p>æ‡’æ±‰å¼ç›¸å¯¹äºé¥¿æ±‰å¼çš„ä¼˜åŠ¿æ˜¯æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚è¿™ç§å®ç°æ–¹å¼ä¼šå¯¼è‡´é¢‘ç¹åŠ é”ã€é‡Šæ”¾é”ï¼Œä»¥åŠå¹¶å‘åº¦ä½ç­‰é—®é¢˜ï¼Œé¢‘ç¹çš„è°ƒç”¨ä¼šäº§ç”Ÿæ€§èƒ½ç“¶é¢ˆã€‚</p><ul><li><strong>åŒé‡æ£€æµ‹</strong></li></ul><p>åŒé‡æ£€æµ‹å®ç°æ–¹å¼æ—¢æ”¯æŒå»¶è¿ŸåŠ è½½ã€åˆæ”¯æŒé«˜å¹¶å‘çš„å•ä¾‹å®ç°æ–¹å¼ã€‚åªè¦ instance è¢«åˆ›å»ºä¹‹åï¼Œå†è°ƒç”¨ getInstance() å‡½æ•°éƒ½ä¸ä¼šè¿›å…¥åˆ°åŠ é”é€»è¾‘ä¸­ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹å¼è§£å†³äº†æ‡’æ±‰å¼å¹¶å‘åº¦ä½çš„é—®é¢˜ã€‚</p><ul><li><strong>é™æ€å†…éƒ¨ç±»</strong></li></ul><p>åˆ©ç”¨ Java çš„é™æ€å†…éƒ¨ç±»æ¥å®ç°å•ä¾‹ã€‚è¿™ç§å®ç°æ–¹å¼ï¼Œæ—¢æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œä¹Ÿæ”¯æŒé«˜å¹¶å‘ï¼Œå®ç°èµ·æ¥ä¹Ÿæ¯”åŒé‡æ£€æµ‹ç®€å•ã€‚</p><ul><li><strong>æšä¸¾</strong></li></ul><p>æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼ŒåŸºäºæšä¸¾ç±»å‹çš„å•ä¾‹å®ç°ã€‚è¿™ç§å®ç°æ–¹å¼é€šè¿‡ Java æšä¸¾ç±»å‹æœ¬èº«çš„ç‰¹æ€§ï¼Œä¿è¯äº†å®ä¾‹åˆ›å»ºçš„çº¿ç¨‹å®‰å…¨æ€§å’Œå®ä¾‹çš„å”¯ä¸€æ€§ã€‚</p><p><strong>4. å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ</strong></p><ul><li><p>å•ä¾‹å¯¹ OOP ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½</p></li><li><p>å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»</p></li><li><p>å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½</p></li><li><p>å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½</p></li><li><p>å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°</p></li></ul><p><strong>5. å•ä¾‹æœ‰ä»€ä¹ˆæ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ</strong></p><p>ä¸ºäº†ä¿è¯å…¨å±€å”¯ä¸€ï¼Œé™¤äº†ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨é™æ€æ–¹æ³•æ¥å®ç°ã€‚ä¸è¿‡ï¼Œé™æ€æ–¹æ³•è¿™ç§å®ç°æ€è·¯ï¼Œå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é—®é¢˜ã€‚å¦‚æœè¦å®Œå…¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä»æ ¹ä¸Šï¼Œå¯»æ‰¾å…¶ä»–æ–¹å¼æ¥å®ç°å…¨å±€å”¯ä¸€ç±»äº†ã€‚æ¯”å¦‚ï¼Œé€šè¿‡å·¥å‚æ¨¡å¼ã€IOC å®¹å™¨ï¼ˆæ¯”å¦‚ Spring IOC å®¹å™¨ï¼‰æ¥ä¿è¯ï¼Œç”±è¿‡ç¨‹åºå‘˜è‡ªå·±æ¥ä¿è¯ï¼ˆè‡ªå·±åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™è‡ªå·±ä¿è¯ä¸è¦åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡ï¼‰ã€‚</p><p>æœ‰äººæŠŠå•ä¾‹å½“ä½œåæ¨¡å¼ï¼Œä¸»å¼ æœç»åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚æˆ‘ä¸ªäººè§‰å¾—è¿™æœ‰ç‚¹æç«¯ã€‚æ¨¡å¼æ²¡æœ‰å¯¹é”™ï¼Œå…³é”®çœ‹ä½ æ€ä¹ˆç”¨ã€‚å¦‚æœå•ä¾‹ç±»å¹¶æ²¡æœ‰åç»­æ‰©å±•çš„éœ€æ±‚ï¼Œå¹¶ä¸”ä¸ä¾èµ–å¤–éƒ¨ç³»ç»Ÿï¼Œé‚£è®¾è®¡æˆå•ä¾‹ç±»å°±æ²¡æœ‰å¤ªå¤§é—®é¢˜ã€‚å¯¹äºä¸€äº›å…¨å±€çš„ç±»ï¼Œæˆ‘ä»¬åœ¨å…¶ä»–åœ°æ–¹ new çš„è¯ï¼Œè¿˜è¦åœ¨ç±»ä¹‹é—´ä¼ æ¥ä¼ å»ï¼Œä¸å¦‚ç›´æ¥åšæˆå•ä¾‹ç±»ï¼Œä½¿ç”¨èµ·æ¥ç®€æ´æ–¹ä¾¿ã€‚</p><p><strong>6. å¦‚ä½•ç†è§£å•ä¾‹æ¨¡å¼çš„å”¯ä¸€æ€§ï¼Ÿ</strong></p><p>å•ä¾‹ç±»ä¸­å¯¹è±¡çš„å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´æ˜¯â€œè¿›ç¨‹å”¯ä¸€â€çš„ã€‚â€œè¿›ç¨‹å”¯ä¸€â€æŒ‡çš„æ˜¯è¿›ç¨‹å†…å”¯ä¸€ï¼Œè¿›ç¨‹é—´ä¸å”¯ä¸€ï¼›â€œçº¿ç¨‹å”¯ä¸€â€æŒ‡çš„æ˜¯çº¿ç¨‹å†…å”¯ä¸€ï¼Œçº¿ç¨‹é—´å¯ä»¥ä¸å”¯ä¸€ã€‚å®é™…ä¸Šï¼Œâ€œè¿›ç¨‹å”¯ä¸€â€å°±æ„å‘³ç€çº¿ç¨‹å†…ã€çº¿ç¨‹é—´éƒ½å”¯ä¸€ï¼Œè¿™ä¹Ÿæ˜¯â€œè¿›ç¨‹å”¯ä¸€â€å’Œâ€œçº¿ç¨‹å”¯ä¸€â€çš„åŒºåˆ«ä¹‹å¤„ã€‚â€œé›†ç¾¤å”¯ä¸€â€æŒ‡çš„æ˜¯è¿›ç¨‹å†…å”¯ä¸€ã€è¿›ç¨‹é—´ä¹Ÿå”¯ä¸€ã€‚</p><p><strong>7. å¦‚ä½•å®ç°çº¿ç¨‹å”¯ä¸€çš„å•ä¾‹ï¼Ÿ</strong></p><p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª HashMap æ¥å­˜å‚¨å¯¹è±¡ï¼Œå…¶ä¸­ key æ˜¯çº¿ç¨‹ IDï¼Œvalue æ˜¯å¯¹è±¡ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åšåˆ°ï¼Œä¸åŒçš„çº¿ç¨‹å¯¹åº”ä¸åŒçš„å¯¹è±¡ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹åªèƒ½å¯¹åº”ä¸€ä¸ªå¯¹è±¡ã€‚å®é™…ä¸Šï¼ŒJava è¯­è¨€æœ¬èº«æä¾›äº† ThreadLocal å¹¶å‘å·¥å…·ç±»ï¼Œå¯ä»¥æ›´åŠ è½»æ¾åœ°å®ç°çº¿ç¨‹å”¯ä¸€å•ä¾‹ã€‚</p><p><strong>8. å¦‚ä½•å®ç°é›†ç¾¤ç¯å¢ƒä¸‹çš„å•ä¾‹ï¼Ÿ</strong></p><p>æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡åºåˆ—åŒ–å¹¶å­˜å‚¨åˆ°å¤–éƒ¨å…±äº«å­˜å‚¨åŒºï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰ã€‚è¿›ç¨‹åœ¨ä½¿ç”¨è¿™ä¸ªå•ä¾‹å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦å…ˆä»å¤–éƒ¨å…±äº«å­˜å‚¨åŒºä¸­å°†å®ƒè¯»å–åˆ°å†…å­˜ï¼Œå¹¶ååºåˆ—åŒ–æˆå¯¹è±¡ï¼Œç„¶åå†ä½¿ç”¨ï¼Œä½¿ç”¨å®Œæˆä¹‹åè¿˜éœ€è¦å†å­˜å‚¨å›å¤–éƒ¨å…±äº«å­˜å‚¨åŒºã€‚ä¸ºäº†ä¿è¯ä»»ä½•æ—¶åˆ»åœ¨è¿›ç¨‹é—´éƒ½åªæœ‰ä¸€ä»½å¯¹è±¡å­˜åœ¨ï¼Œä¸€ä¸ªè¿›ç¨‹åœ¨è·å–åˆ°å¯¹è±¡ä¹‹åï¼Œéœ€è¦å¯¹å¯¹è±¡åŠ é”ï¼Œé¿å…å…¶ä»–è¿›ç¨‹å†å°†å…¶è·å–ã€‚åœ¨è¿›ç¨‹ä½¿ç”¨å®Œè¿™ä¸ªå¯¹è±¡ä¹‹åï¼Œéœ€è¦æ˜¾å¼åœ°å°†å¯¹è±¡ä»å†…å­˜ä¸­åˆ é™¤ï¼Œå¹¶ä¸”é‡Šæ”¾å¯¹å¯¹è±¡çš„åŠ é”ã€‚</p><p><strong>9. å¦‚ä½•å®ç°ä¸€ä¸ªå¤šä¾‹æ¨¡å¼ï¼Ÿ</strong></p><p>â€œå•ä¾‹â€æŒ‡çš„æ˜¯ä¸€ä¸ªç±»åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚å¯¹åº”åœ°ï¼Œâ€œå¤šä¾‹â€æŒ‡çš„å°±æ˜¯ä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸ªæ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ¯”å¦‚åªèƒ½åˆ›å»º 3 ä¸ªå¯¹è±¡ã€‚å¤šä¾‹çš„å®ç°ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œé€šè¿‡ä¸€ä¸ª Map æ¥å­˜å‚¨å¯¹è±¡ç±»å‹å’Œå¯¹è±¡ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œæ¥æ§åˆ¶å¯¹è±¡çš„ä¸ªæ•°ã€‚</p><h2 id="æ€è€ƒé¢˜" tabindex="-1"><a class="header-anchor" href="#æ€è€ƒé¢˜"><span><strong>æ€è€ƒé¢˜</strong></span></a></h2><p>åœ¨ä½ æ‰€ç†Ÿæ‚‰çš„ç¼–ç¨‹è¯­è¨€çš„ç±»åº“ä¸­ï¼Œæœ‰å“ªäº›ç±»æ˜¯å•ä¾‹ç±»ï¼Ÿåˆä¸ºä»€ä¹ˆè¦è®¾è®¡æˆå•ä¾‹ç±»å‘¢ï¼Ÿ</p><blockquote><p>java beanå¤§éƒ¨åˆ†éƒ½æ˜¯å•ä¾‹å§ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„service beanï¼Œå•ä¾‹ä¹Ÿæ˜¯ä¸ºäº†å¤ç”¨ç±»å’Œèµ„æºå…±äº«å§ï¼Œä½†æ˜¯è¦æ³¨æ„å•ä¾‹éœ€è¦æ— çŠ¶æ€ï¼Œæœ‰çŠ¶æ€çš„åˆ™è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜</p></blockquote><p>åœ¨ç¬¬ä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹ä¸­ï¼Œé™¤äº†æˆ‘ä»¬è®²åˆ°çš„ç±»çº§åˆ«é”ã€åˆ†å¸ƒå¼é”ã€å¹¶å‘é˜Ÿåˆ—ã€å•ä¾‹æ¨¡å¼ç­‰è§£å†³æ–¹æ¡ˆä¹‹å¤–ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸€ç§éå¸¸ç®€å•çš„è§£å†³æ—¥å¿—äº’ç›¸è¦†ç›–é—®é¢˜çš„æ–¹æ³•ï¼Œä½ æƒ³åˆ°äº†å—ï¼Ÿ</p><blockquote><p>åˆ›å»ºä¸€ä¸ªé™æ€ç§æœ‰çš„filewritterï¼Œå¤šçº¿ç¨‹æˆ–è€…å¤šä¸ªLoggerå¯¹è±¡å…±äº«ä¸€ä¸ªfilewritterã€‚</p></blockquote><p>å¦‚æœé¡¹ç›®ä¸­å·²ç»ç”¨äº†å¾ˆå¤šå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æ„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Demo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> UserRepo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> userRepo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // é€šè¿‡æ„é€ å“ˆå‡½æ•°æˆ–IOCå®¹å™¨ä¾èµ–æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> validateCachedUser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">long</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> userId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    User</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> cachedUser</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> CacheManager</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getUser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(userId);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    User</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> actualUser</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> userRepo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getUser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(userId);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><blockquote><p>æŠŠä»£ç â€œUser cachedUser = CacheManager.getInstance().getUser(userId);â€å•ç‹¬æå–å‡ºæ¥åšæˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œè¿™æ ·è¿™ä¸ªå‡½æ•°å°±å¯ä»¥è¿›è¡Œmockäº†ï¼Œè¿›è€Œæ–¹ä¾¿æµ‹è¯•validateCachedUserã€‚</p></blockquote><p>åœ¨å•ä¾‹æ”¯æŒå‚æ•°ä¼ é€’çš„ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸¤æ¬¡æ‰§è¡Œ getInstance(paramA, paramB) æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Singleton</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> singleton2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre></div><blockquote><p>å¯ä»¥åˆ¤æ–­ä¼ è¿›æ¥çš„å‚æ•°å’Œå·²ç»å­˜åœ¨çš„instanceé‡Œé¢çš„ä¸¤ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œå°±ç›´æ¥è¿”å›å·²ç»å­˜åœ¨çš„instanceï¼Œå¦åˆ™å°±æ–°åˆ›å»ºä¸€ä¸ªinstanceè¿”å›ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> synchronized</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Singleton</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> paramB) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">   instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> paramB)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> paramA </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;&amp;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">paramB</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> paramB) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">   return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">   instance </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(paramA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> paramB)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> instance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre></div></blockquote><p>åœ¨æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°å•ä¾‹å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´æ˜¯è¿›ç¨‹ï¼Œå®é™…ä¸Šï¼Œå¯¹äº Java è¯­è¨€æ¥è¯´ï¼Œå•ä¾‹ç±»å¯¹è±¡çš„å”¯ä¸€æ€§çš„ä½œç”¨èŒƒå›´å¹¶éè¿›ç¨‹ï¼Œè€Œæ˜¯ç±»åŠ è½½å™¨ï¼ˆClass Loaderï¼‰ï¼Œä½ èƒ½è‡ªå·±ç ”ç©¶å¹¶è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆå—ï¼Ÿ</p><blockquote><p>Javaä¸­ï¼Œä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ªClassæ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸ç­‰ã€‚å•ä¾‹ç±»å¯¹è±¡çš„å”¯ä¸€æ€§å‰æä¹Ÿå¿…é¡»ä¿è¯è¯¥ç±»è¢«åŒä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½ï¼</p><p>è¦å›ç­”è¿™ä¸ªè¯¾åé—®é¢˜ï¼Œè¦ç†è§£classloaderå’ŒJDK8ä¸­ä½¿ç”¨çš„åŒäº²å§”æ´¾æ¨¡å‹ã€‚</p><p>classloaderæœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p><ol><li>ç”¨äºå°†classæ–‡ä»¶åŠ è½½åˆ°JVMä¸­ï¼›</li><li>ç¡®è®¤æ¯ä¸ªç±»åº”è¯¥ç”±å“ªä¸ªç±»åŠ è½½å™¨åŠ è½½ï¼Œå¹¶ä¸”ä¹Ÿç”¨äºåˆ¤æ–­JVMè¿è¡Œæ—¶çš„ä¸¤ä¸ªç±»æ˜¯å¦ç›¸ç­‰ã€‚</li></ol><p>åŒäº²å§”æ´¾æ¨¡å‹çš„åŸç†æ˜¯å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ¥æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼Œé¦–å…ˆä¼šè¯·æ±‚å…¶çˆ¶ç±»åŠ è½½å™¨åŠ è½½ï¼Œæ¯ä¸€å±‚éƒ½æ˜¯å¦‚æ­¤ï¼Œå½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•æ‰¾åˆ°è¿™ä¸ªç±»æ—¶ï¼ˆæ ¹æ®ç±»çš„å…¨é™å®šåç§°ï¼‰ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚æ‰€ä»¥åŒäº²å§”æ´¾æ¨¡å‹è§£å†³äº†ç±»é‡å¤åŠ è½½çš„é—®é¢˜ï¼Œ æ¯”å¦‚å¯ä»¥è¯•æƒ³æ²¡æœ‰åŒäº²å§”æ´¾æ¨¡å‹æ—¶ï¼Œå¦‚æœç”¨æˆ·è‡ªå·±å†™äº†ä¸€ä¸ªå…¨é™å®šåä¸ºjava.lang.Objectçš„ç±»ï¼Œå¹¶ç”¨è‡ªå·±çš„ç±»åŠ è½½å™¨å»åŠ è½½ï¼ŒåŒæ—¶BootstrapClassLoaderåŠ è½½äº†rt.jaråŒ…ä¸­çš„JDKæœ¬èº«çš„java.lang.Objectï¼Œè¿™æ ·å†…å­˜ä¸­å°±å­˜åœ¨ä¸¤ä»½Objectç±»äº†ï¼Œæ­¤æ—¶å°±ä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ï¼Œä¾‹å¦‚æ ¹æ®å…¨é™å®šåæ— æ³•å®šä½åˆ°å…·ä½“çš„ç±»ã€‚æœ‰äº†åŒäº²å§”æ´¾æ¨¡å‹åï¼Œæ‰€æœ‰çš„ç±»åŠ è½½æ“ä½œéƒ½ä¼šä¼˜å…ˆå§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå³ä½¿ç”¨æˆ·è‡ªå®šä¹‰äº†ä¸€ä¸ªjava.lang.Objectï¼Œä½†ç”±äºBootstrapClassLoaderå·²ç»æ£€æµ‹åˆ°è‡ªå·±åŠ è½½äº†è¿™ä¸ªç±»ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å°±ä¸ä¼šå†é‡å¤åŠ è½½äº†ã€‚æ‰€ä»¥ï¼ŒåŒäº²å§”æ´¾æ¨¡å‹èƒ½å¤Ÿä¿è¯ç±»åœ¨å†…å­˜ä¸­çš„å”¯ä¸€æ€§ã€‚</p><p>è”ç³»åˆ°è¯¾åçš„é—®é¢˜ï¼Œæ‰€ä»¥ç”¨æˆ·å®šä¹‰äº†å•ä¾‹ç±»ï¼Œè¿™æ ·JDKä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹åŠ è½½ä¸€æ¬¡ä¹‹åå°±ä¸ä¼šé‡å¤åŠ è½½äº†ï¼Œä¿è¯äº†å•ä¾‹ç±»çš„è¿›ç¨‹å†…çš„å”¯ä¸€æ€§ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯classloaderå†…çš„å”¯ä¸€æ€§ã€‚å½“ç„¶ï¼Œå¦‚æœæ²¡æœ‰åŒäº²å§”æ´¾æ¨¡å‹ï¼Œé‚£ä¹ˆå¤šä¸ªclassloaderå°±ä¼šæœ‰å¤šä¸ªå®ä¾‹ï¼Œæ— æ³•ä¿è¯å”¯ä¸€æ€§ã€‚</p></blockquote></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°</span><time class="vp-meta-info" datetime="2025-06-21T15:03:37.000Z" data-allow-mismatch>2025/6/21 15:03</time></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1134685563@qq.com">weiser</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link route-link-active auto-link prev" href="/basics/design-patterns/creational-patterns/" aria-label="æ¦‚è¿°"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->æ¦‚è¿°</div></a><a class="route-link auto-link next" href="/basics/design-patterns/creational-patterns/factory-method.html" aria-label="å·¥å‚æ–¹æ³•"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">å·¥å‚æ–¹æ³•<!----></div></a></nav><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;"><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">é»˜è®¤é¡µè„š</div><div class="vp-copyright">Copyright Â© 2025 Weiser </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-mRFOk-Ym.js" defer></script>
  </body>
</html>
