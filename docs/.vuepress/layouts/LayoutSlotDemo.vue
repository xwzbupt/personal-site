<script setup lang="ts">
import { Layout } from "vuepress-theme-hope/client";
import { onMounted } from "vue";

// ç§»åŠ¨ç«¯ç‚¹å‡»å±•å¼€äºŒç»´ç 
onMounted(() => {
  const btns = document.querySelectorAll(".reward-btn");
  btns.forEach((btn) => {
    btn.addEventListener("click", (e) => {
      // å¦‚æœæŒ‰é’®æœ¬èº«è®¾ç½®äº†è·³è½¬ï¼Œå°±ä¸è¦å±•å¼€äºŒç»´ç 
      if ((e.target as HTMLElement).closest("button")?.dataset.link) {
        return;
      }
      btns.forEach((b) => b.classList.remove("active"));
      btn.classList.toggle("active");
    });
  });
});

// ç‚¹å‡»è·³è½¬å‡½æ•°
function goToArticle(path: string) {
  // å½“å‰é¡µé¢è·³è½¬
  window.open(path, "_blank");

  // å¦‚æœè¦æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼Œè¯·æ”¹æˆï¼š
  // window.open(path, "_blank");
}
</script>

<template>
  <Layout>
    <!-- åœ¨å³ä¾§ç›®å½•çš„ä¸Šæ–¹æ·»åŠ å¹¿å‘Š -->
    <!-- <template #tocBefore>
      <div>å¹¿å‘Š</div>
    </template> -->

    <!-- åœ¨å³ä¾§ç›®å½•çš„ä¸‹æ–¹æ·»åŠ èµèµç  -->
    <template #tocAfter>
      <div style="margin-top: 1em">
        <div style="display: flex; gap: 10px">
          <!-- æŒ‰é’®ï¼šæ”¯æŒæˆ‘ï¼ˆç‚¹å‡»è·³è½¬ + æ‚¬åœäºŒç»´ç ï¼‰ -->
          <div class="reward-btn">
            <button
              class="support-btn"
              data-link="true"
              @click="goToArticle('https://www.baidu.com')"
            >
              â¤ï¸æ”¯æŒæˆ‘
            </button>
            <div class="reward-popup">
              <img src="/reward-code.png" alt="èµèµç " />
            </div>
          </div>

          <!-- æŒ‰é’®ï¼šäº¤æµåœˆï¼ˆä»…äºŒç»´ç ï¼Œä¸è·³è½¬ï¼‰ -->
          <div class="reward-btn">
            <button class="support-btn">ğŸ’¬äº¤æµåœˆ</button>
            <div class="reward-popup">
              <img src="/wechat-code.png" alt="äº¤æµåœˆäºŒç»´ç " />
            </div>
          </div>
        </div>
      </div>
    </template>
  </Layout>
</template>

<style scoped>
.support-btn {
  padding: 6px 12px;
  border: 1px solid #d9d9d9;
  border-radius: 6px;
  background: white;
  color: #333;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
}
.support-btn:hover {
  border-color: #ff4d4f;
  color: #ff4d4f;
}

.reward-btn {
  position: relative;
  display: inline-block;
}

.reward-popup {
  position: absolute;
  bottom: 110%;
  left: 50%;
  transform: translateX(-50%);
  display: none;
  background: white;
  padding: 6px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 10;
}
.reward-popup img {
  max-width: 320px;
  border-radius: 6px;
}

/* PC: é¼ æ ‡æ‚¬åœå‡ºç°äºŒç»´ç  */
.reward-btn:hover .reward-popup {
  display: block;
}

/* Mobile: ç‚¹å‡»æŒ‰é’®å‡ºç°äºŒç»´ç  */
@media (hover: none) {
  .reward-btn .reward-popup {
    display: none;
  }
  .reward-btn.active .reward-popup {
    display: block;
  }
}
</style>
